# üõ°Ô∏è –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–º–æ—â—å—é Lynis –Ω–∞ Ubuntu 22.04

## üìã –ß—Ç–æ —Ç–∞–∫–æ–µ Lynis?

**Lynis** ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–æ–¥–∏—Ç –≥–ª—É–±–æ–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —Å–∏—Å—Ç–µ–º—ã Linux/macOS/UNIX. –û–Ω –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–∏—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –¥–∞–µ—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å–∏–ª–µ–Ω–∏—é –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Lynis

### **–°–ø–æ—Å–æ–± 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤**
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Lynis
sudo apt install -y lynis

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
lynis --version
```

### **–°–ø–æ—Å–æ–± 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏ –≤—Ä—É—á–Ω—É—é**
```bash
# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏
cd /tmp
wget https://downloads.cisofy.com/lynis/lynis-3.0.9.tar.gz

# –†–∞—Å–ø–∞–∫–æ–≤–∫–∞
tar xvf lynis-3.0.9.tar.gz
cd lynis

# –ó–∞–ø—É—Å–∫ –±–µ–∑ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
./lynis audit system
```

---

## üîç –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞

### **–ë–∞–∑–æ–≤—ã–π –∞—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã**
```bash
sudo lynis audit system
```

### **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞—É–¥–∏—Ç —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º**
```bash
sudo lynis audit system --verbose
```

### **–ê—É–¥–∏—Ç —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏**
```bash
# –¢–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
sudo lynis audit system --tests-from-category "security"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –ø–ª–∞–≥–∏–Ω–æ–≤
sudo lynis audit system --plugin-list
```

---

## üìä –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞—É–¥–∏—Ç–∞

### **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –≤—ã–≤–æ–¥–∞ Lynis**

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞—É–¥–∏—Ç–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ:

```
================================================================================

  Lynis 3.0.9

  Hardening and security scanning tool for Linux, macOS, and UNIX-based systems

  2007-2023, CISOfy - https://cisofy.com/lynis/
  Enterprise support available (compliance, plugins, interface, tools)

================================================================================

[+] Initializing program
...
```

### **–ö–ª—é—á–µ–≤—ã–µ —Å–µ–∫—Ü–∏–∏ –æ—Ç—á–µ—Ç–∞:**

#### **1. –°–≤–æ–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤**
```
Tests: 291
Components: [...................]
```

#### **2. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–æ–∫**
```
[ OK ]      Firewall is active
[ WARNING ] No password set for single mode
[ SUGGESTION ] Set a password for single user mode [test: BOOT-5122] [details: ] [solution: run 'passwd' to set a password]
```

#### **3. –û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```
Hardening index : 65 [#################----]
```

#### **4. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**
```
  - Suggestions (25)
  - Warnings (3)
```

---

## üìã –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –ø—Ä–æ–≤–µ—Ä–æ–∫ Lynis

### **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫:**

| **–ö–∞—Ç–µ–≥–æ—Ä–∏—è** | **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç** | **–í–∞–∂–Ω–æ—Å—Ç—å** |
|---------------|-------------------|--------------|
| **Boot and services** | –ó–∞–≥—Ä—É–∑—á–∏–∫–∏, —Å–µ—Ä–≤–∏—Å—ã | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **Kernel** | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —è–¥—Ä–∞ | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **Memory and processes** | –ü–∞–º—è—Ç—å, –ø—Ä–æ—Ü–µ—Å—Å—ã | üü† –í—ã—Å–æ–∫–∞—è |
| **Users, groups and authentication** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **Shells** | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–æ–ª–æ—á–µ–∫ | üü° –°—Ä–µ–¥–Ω—è—è |
| **File systems** | –§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã | üü† –í—ã—Å–æ–∫–∞—è |
| **Storage** | –•—Ä–∞–Ω–∏–ª–∏—â–µ | üü° –°—Ä–µ–¥–Ω—è—è |
| **Networking** | –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| **Ports and packages** | –ü–æ—Ä—Ç–∏, –ø–∞–∫–µ—Ç—ã | üü† –í—ã—Å–æ–∫–∞—è |
| **Software** | –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û | üü† –í—ã—Å–æ–∫–∞—è |
| **File permissions** | –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º | üü† –í—ã—Å–æ–∫–∞—è |
| **Logging and files** | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | üü° –°—Ä–µ–¥–Ω—è—è |
| **Scheduling** | –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∏ –∑–∞–¥–∞—á | üü° –°—Ä–µ–¥–Ω—è—è |
| **Cryptography** | –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è | üü† –í—ã—Å–æ–∫–∞—è |
| **Malware** | –ê–Ω—Ç–∏–≤–∏—Ä—É—Å–Ω–∞—è –∑–∞—â–∏—Ç–∞ | üü† –í—ã—Å–æ–∫–∞—è |

---

## üõ†Ô∏è –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—É–¥–∏—Ç—É

### **–®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞—É–¥–∏—Ç—É**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤
sudo mkdir -p /var/log/lynis-reports
cd /var/log/lynis-reports

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
df -h
```

### **–®–∞–≥ 2: –ó–∞–ø—É—Å–∫ –ø–æ–ª–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞**
```bash
# –ó–∞–ø—É—Å–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –æ—Ç—á–µ—Ç–∞
sudo lynis audit system --auditor "–í–∞—à–µ_–ò–º—è" --logfile /var/log/lynis-reports/audit-$(date +%Y%m%d).log
```

### **–®–∞–≥ 3: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
–í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Lynis –ø–æ–∫–∞–∂–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å:
```
[##-------] 10% (30/291) | Performing test: KRNL-5789
```

---

## üìà –ê–Ω–∞–ª–∏–∑ –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### **–ü–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫:**

- **üü¢ 0-49** - –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **üü° 50-74** - –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏  
- **üü† 75-89** - –í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **üî¥ 90-100** - –û—á–µ–Ω—å –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### **–¢–∏–ø—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:**

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
sudo grep -E "(Suggestion|Warning)" /var/log/lynis-reports/audit-*.log

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
sudo grep "CRITICAL" /var/log/lynis-reports/audit-*.log

# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
sudo grep "suggestion" /var/log/lynis-reports/audit-*.log -i
```

---

## üîß –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞—É–¥–∏—Ç–æ–≤

### **–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞**
```bash
sudo nano /opt/scripts/lynis-audit.sh
```

```bash
#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∞—É–¥–∏—Ç–∞ Lynis

DATE=$(date +%Y%m%d)
LOG_DIR="/var/log/lynis-reports"
LOG_FILE="$LOG_DIR/lynis-audit-$DATE.log"
REPORT_FILE="$LOG_DIR/lynis-report-$DATE.txt"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –ª–æ–≥–æ–≤
mkdir -p $LOG_DIR

echo "=== –ó–ê–ü–£–°–ö –ê–£–î–ò–¢–ê LYNIS ===" > $REPORT_FILE
echo "–î–∞—Ç–∞: $(date)" >> $REPORT_FILE
echo "–°–∏—Å—Ç–µ–º–∞: $(hostname)" >> $REPORT_FILE
echo >> $REPORT_FILE

# –ó–∞–ø—É—Å–∫ –∞—É–¥–∏—Ç–∞
echo "–ó–∞–ø—É—Å–∫ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞..."
sudo lynis audit system --logfile $LOG_FILE --report-file $REPORT_FILE

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–¥–∫–∏ –≤ –æ—Ç—á–µ—Ç
echo "=== –°–í–û–î–ö–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô ===" >> $REPORT_FILE
sudo grep -c "Suggestion" $LOG_FILE >> $REPORT_FILE
sudo grep -c "Warning" $LOG_FILE >> $REPORT_FILE

echo "–ê—É–¥–∏—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –û—Ç—á–µ—Ç: $REPORT_FILE"
```

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /opt/scripts/lynis-audit.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
sudo /opt/scripts/lynis-audit.sh
```

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –∞—É–¥–∏—Ç–æ–≤ —á–µ—Ä–µ–∑ cron**
```bash
sudo crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞
0 2 * * 0 /opt/scripts/lynis-audit.sh > /dev/null 2>&1

# –ò–ª–∏ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π –∞—É–¥–∏—Ç –≤ 3:00
0 3 * * * /opt/scripts/lynis-audit.sh > /dev/null 2>&1
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

### **–ü—Ä–∏–º–µ—Ä 1: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –ø–∞—Ä–æ–ª–µ single user mode**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è –¥–ª—è single user mode
sudo passwd root
```

### **–ü—Ä–∏–º–µ—Ä 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–∞–µ—Ä–≤–æ–ª–∞**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ UFW
sudo apt install ufw
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow ssh
```

### **–ü—Ä–∏–º–µ—Ä 3: –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ SSH**
```bash
sudo nano /etc/ssh/sshd_config

# –î–æ–±–∞–≤—å—Ç–µ/–∏–∑–º–µ–Ω–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏:
PermitRootLogin no
PasswordAuthentication no
Protocol 2
MaxAuthTries 3
```

### **–ü—Ä–∏–º–µ—Ä 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**
```bash
sudo apt install unattended-upgrades
sudo dpkg-reconfigure unattended-upgrades
```

---

## üìä –°–æ–∑–¥–∞–Ω–∏–µ —Å–≤–æ–¥–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞

### **–°–∫—Ä–∏–ø—Ç –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
```bash
sudo nano /opt/scripts/lynis-report-generator.sh
```

```bash
#!/bin/bash
# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ—Ç—á–µ—Ç–æ–≤ Lynis

LOG_FILE="$1"
REPORT_FILE="/tmp/lynis-summary-$(date +%Y%m%d).html"

if [ -z "$LOG_FILE" ]; then
    echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 <lynis-log-file>"
    exit 1
fi

{
echo "<html>"
echo "<head>"
echo "<title>–û—Ç—á–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Lynis</title>"
echo "<style>"
echo "body { font-family: Arial, sans-serif; margin: 20px; }"
echo ".critical { color: red; font-weight: bold; }"
echo ".warning { color: orange; }"
echo ".suggestion { color: blue; }"
echo ".ok { color: green; }"
echo "</style>"
echo "</head>"
echo "<body>"
echo "<h1>–û—Ç—á–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Lynis</h1>"
echo "<p>–î–∞—Ç–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: $(date)</p>"
echo "<p>–§–∞–π–ª –ª–æ–≥–∞: $LOG_FILE</p>"
echo "<hr>"

# –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
echo "<h2>üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</h2>"
grep -i "critical" "$LOG_FILE" | while read line; do
    echo "<p class='critical'>$line</p>"
done

# –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
echo "<h2>üü† –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è</h2>"
grep "Warning" "$LOG_FILE" | while read line; do
    echo "<p class='warning'>$line</p>"
done

# –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
echo "<h2>üîµ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>"
grep "Suggestion" "$LOG_FILE" | head -20 | while read line; do
    echo "<p class='suggestion'>$line</p>"
done

echo "</body>"
echo "</html>"
} > "$REPORT_FILE"

echo "HTML –æ—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $REPORT_FILE"
```

```bash
sudo chmod +x /opt/scripts/lynis-report-generator.sh

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
sudo /opt/scripts/lynis-report-generator.sh /var/log/lynis-reports/audit-20231211.log
```

---

## üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Lynis

### **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã**
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è —Å–∏—Å—Ç–µ–º—ã
sudo lynis show profiles

# –ê—É–¥–∏—Ç —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª–µ–º
sudo lynis audit system --profile "server"
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è CIS benchmarks
sudo lynis audit system --tests-from-group "cis"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞
sudo lynis audit system --tests-from-group "cis_level_1"
```

### **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º**
```bash
# –≠–∫—Å–ø–æ—Ä—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ JSON
sudo lynis audit system --report-file /tmp/lynis-report.json --format json

# –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
sudo lynis audit system --report-file /tmp/lynis-report.csv --format csv
```

---

## üìù –ß–µ–∫–ª–∏—Å—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ—Å–ª–µ –∞—É–¥–∏—Ç–∞

### **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- [ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è single user mode
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –≤–∫–ª—é—á–∏—Ç—å —Ñ–∞–µ—Ä–≤–æ–ª
- [ ] –û—Ç–∫–ª—é—á–∏—Ç—å root –≤—Ö–æ–¥ –ø–æ SSH
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º —Ñ–∞–π–ª–∞–º

### **–°—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –í–Ω–µ–¥—Ä–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–æ–≤
- [ ] –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞ Lynis

### **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:**
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –∞—É–¥–∏—Ç—ã
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å SIEM —Å–∏—Å—Ç–µ–º–æ–π
- [ ] –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã
- [ ] –†–µ–≥—É–ª—è—Ä–Ω–æ –ø–µ—Ä–µ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

## üéØ –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

### **–î–µ–Ω—å 1: –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç**
```bash
sudo lynis audit system --logfile /var/log/lynis-initial.log
```

### **–î–µ–Ω—å 2: –ê–Ω–∞–ª–∏–∑ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è**
```bash
# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
grep -c "Warning" /var/log/lynis-initial.log
grep -c "Suggestion" /var/log/lynis-initial.log

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –¥–µ–π—Å—Ç–≤–∏–π
sudo grep "Warning\|Suggestion" /var/log/lynis-initial.log > /tmp/action-plan.txt
```

### **–î–µ–Ω—å 3-7: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–∏–π**
```bash
# –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
```

### **–î–µ–Ω—å 8: –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π –∞—É–¥–∏—Ç**
```bash
sudo lynis audit system --logfile /var/log/lynis-followup.log
```

### **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
```bash
# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–æ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
echo "–ù–∞—á–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞:"
grep "Hardening index" /var/log/lynis-initial.log

echo "–¢–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞:"
grep "Hardening index" /var/log/lynis-followup.log
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

Lynis ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- üéØ –í—ã—è–≤–ª—è—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üìä –û—Ü–µ–Ω–∏–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã  
- üîß –ü–æ–ª—É—á–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
- üìà –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —É—Å–∏–ª–µ–Ω–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã –∞—É–¥–∏—Ç–∞

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —á–∞—Å—Ç–æ—Ç–∞ –∞—É–¥–∏—Ç–æ–≤:**
- üî¥ –ü—Ä–æ–¥–∞–∫—à–Ω-—Å–µ—Ä–≤–µ—Ä—ã: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ
- üü° –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ä–µ–¥—ã: –µ–∂–µ–º–µ—Å—è—á–Ω–æ
- üü¢ –†–∞–±–æ—á–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏: –µ–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ

–ù–∞—á–Ω–∏—Ç–µ —Å –±–∞–∑–æ–≤–æ–≥–æ –∞—É–¥–∏—Ç–∞ —Å–µ–≥–æ–¥–Ω—è –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤–Ω–µ–¥—Ä—è–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –∏ –∑–∞—â–∏—â–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã! üõ°Ô∏è