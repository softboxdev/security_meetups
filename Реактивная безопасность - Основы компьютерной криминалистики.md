
---

### **Тема: Реактивная безопасность - Основы компьютерной криминалистики**
#### **5.1. Введение в расследование инцидентов. Жизненный цикл расследования**

---

### **Часть 1: Что такое реактивная безопасность и почему она важна?**

**Реактивная безопасность (Reactive Security)** — это подход к кибербезопасности, который фокусируется на действиях *после* того, как произошел инцидент информационной безопасности. Если проактивная безопасность — это "строить крепкие стены и ставить охранников", то реактивная — это "работа следователя на месте преступления", когда нарушитель уже проник за периметр.

**Цели реактивной безопасности и компьютерной криминалистики:**
1.  **Обнаружение и подтверждение:** Фактически установить, что инцидент имел место.
2.  **Сдерживание и устранение:** Остановить атаку, вытеснить злоумышленника из сети и восстановить нормальную работу систем.
3.  **Анализ и атрибуция:** понять, *как*, *когда* и *кто* совершил атаку.
4.  **Документирование и отчетность:** Собрать доказательства для внутреннего использования, для руководства или для правоохранительных органов.
5.  **Извлечение уроков и улучшение:** Использовать полученные знания для укрепления защитных мер и недопущения повторения инцидента.

**Ключевое понятие: Инцидент информационной безопасности** — это любое событие, которое привело или может привести к нарушению конфиденциальности, целостности или доступности информационных активов. Примеры: утечка данных, заражение вредоносным ПО, DDoS-атака, несанкционированный доступ.

---

### **Часть 2: Жизненный цикл расследования инцидентов**

Расследование киберинцидентов — это не хаотичный процесс, а строгая последовательность действий. Стандартный жизненный цикл включает четыре ключевые фазы.

#### **Фаза 1: Подготовка (Preparation)**

**Это самая важная фаза.** Успех расследования на 90% зависит от того, насколько хорошо вы подготовились *до* того, как что-то случилось. Проводить подготовку, когда атака уже идет, — все равно что учиться плавать, когда тонешь.

**Что входит в подготовку:**
*   **Создание команды реагирования на инциденты (CIRT):** Определение ролей и ответственности (кто руководитель, кто криминалист, кто специалист по сетевым технологиям, кто юрист, кто PR-менеджер).
*   **Разработка плана реагирования на инциденты (IRP):** Пошаговый документ, описывающий, что делать при разных типах инцидентов. Это "инструкция по эксплуатации" в кризисной ситуации.
*   **Инструментарий:** Наличие и регулярное обновление необходимого ПО для сбора доказательств (анализаторы памяти, дисковые образы, инструменты для анализа сетевого трафика).
*   **Юридическая подготовка:** Понимание, какие доказательства являются допустимыми с точки зрения закона (например, для суда). Знание ФЗ-152, ФЗ-187, статей 272-274 УК РФ.
*   **Логирование и мониторинг:** Настройка централизованного сбора логов (SIEM-системы) со всех критически важных систем. Без логов расследование часто невозможно.
*   **Тренировки и учения:** Регулярное проведение учебных тревог для отработки действий команды.

#### **Фаза 2: Сбор доказательств (Collection & Identification)**

Цель этой фазы — сохранить вещественные доказательства в их первоначальном виде, обеспечив их целостность и допустимость.

**Ключевые принципы:**
*   **Не навреди:** Действия следователя не должны изменять оригинальные данные.
*   **Цепочка сохранности (Chain of Custody):** Это документ, который фиксирует, кто, когда, где и с какой целью имел доступ к доказательствам. Любой пропуск в этой цепочке делает доказательства недопустимыми в суде.

**Что собирается и как:**
1.  **Летучие данные (Volatile Data):** Данные, которые исчезают при выключении питания. Собираются в первую очередь!
    *   **Что:** Оперативная память (RAM), список активных сетевых подключений, запущенные процессы, открытые файлы, содержимое ARP-кэша.
    *   **Как:** Специализированные инструменты (Magnet RAM Capture, Volatility, Live Response скрипты).
2.  **Постоянные данные (Persistent Data):** Данные, хранящиеся на носителях.
    *   **Что:** Жесткие диски (HDD/SSD), логи приложений и систем, дампы сетевого трафика (PCAP).
    *   **Как:** Создание **битовых образов (Bit-by-Bit Image)** — точной, посекторной копии диска. Работа ведется только с образом, оригинальный диск изымается и хранится в качестве вещественного доказательства. Инструменты: FTK Imager, Guymager, dd.

#### **Фаза 3: Анализ и расследование (Analysis & Investigation)**

Самая сложная и творческая фаза, где следователь превращает сырые данные в понимание произошедшего.

**Методы и подходы:**
*   **Анализ временных меток (Timeline Analysis):** Построение хронологии событий на основе меток файловой системы (MFT в NTFS), логов и данных реестра. Помогает ответить на вопрос "когда?".
*   **Анализ артефактов ОС:** Поиск следов активности в специфичных местах:
    *   **Windows:** Prefetch-файлы, журналы событий (Event Logs), реестр (например, ключи автозагрузки), AmCache.
    *   **Linux:** История команд bash, журналы (`/var/log`), временные метки файлов.
*   **Анализ памяти (Memory Forensics):** Исследование дампа оперативной памяти для обнаружения руткитов, извлечения паролей, раскрытия запущенных вредоносных процессов, которые не видны на диске.
*   **Анализ сети (Network Forensics):** Изучение дампов сетевого трафика (PCAP-файлы) для выявления аномальных соединений, определения источника атаки и протоколов, которые использовал злоумышленник.
*   **Анализ вредоносного ПО (Malware Analysis):** Изучение поведения и кода вредоносной программы в изолированной среде (песочнице) для понимания ее функционала.

#### **Фаза 4: Отчетность и представление результатов (Reporting & Presentation)**

Без этой фазы вся проделанная работа теряет смысл. Цель — донести выводы до целевой аудитории понятным языком.

**Виды отчетов:**
*   **Технический отчет:** Для ИТ-специалистов и команды безопасности. Содержит детальное описание тактик, техник и процедур (TTPs) злоумышленника, индикаторов компрометации (IOCs) — хэши файлов, IP-адреса, доменные имена.
*   **Отчет для руководства:** Для менеджеров и директоров. Содержит краткую выжимку на бизнес-языке: что произошло, какой финансовый/репутационный ущерб, какие выводы и рекомендации.
*   **Юридический отчет/Заключение эксперта:** Для суда. Составляется по строгой форме, содержит описание цепочки сохранности, все доказательства и выводы, изложенные в строгом соответствии с законодательством.

**После отчета наступает этап "Извлечения уроков" — обновление политик безопасности, установка новых правил на межсетевом экране, обучение сотрудников, что замыкает цикл и переводит реактивные меры в проактивные.**

---

### **Итог**

Расследование инцидентов — это дисциплинированный и методичный процесс, который превращает хаос кибератаки в структурированную историю с доказательствами. Понимание его жизненного цикла является фундаментальным для любого специалиста, работающего в области реактивной безопасности и компьютерной криминалистики.
Конечно, давайте подробно разберем эту фундаментальную тему компьютерной криминалистики.

---

### **Цифровые улики: типы, характеристики, правила сбора и сохранения**

#### **Введение: Что такое цифровые улики?**

**Цифровые улики (Digital Evidence)** — это любая информация или данные, хранящиеся или передаваемые в цифровой форме, которые могут быть использованы для установления обстоятельств киберпреступления или иного противоправного деяния в суде.

**Ключевая особенность:** Цифровые улики крайне хрупки, легко изменяемы и могут быть уничтожены безвозвратно. Один неверный шаг может сделать их непригодными для использования в суде.

---

### **Часть 1: Типы цифровых улик**

Классификация проводится по источнику происхождения и "летучести" данных.

#### **1. По источнику происхождения:**

*   **Данные с компьютеров и ноутбуков:** Жесткие диски, SSD, файлы, журналы операционной системы, реестр Windows, временные файлы.
*   **Мобильные устройства:** Смартфоны, планшеты. Данные включают историю звонков и сообщений (SMS, мессенджеры), геолокацию, фотографии, список контактов, данные приложений.
*   **Сетевые устройства:** Серверы, маршрутизаторы, коммутаторы, межсетевые экраны. Источники: журналы сетевой активности (логи), дампы сетевого трафика (файлы .pcap).
*   **Периферийные устройства:** Принтеры (могут хранить историю печати), USB-флешки, внешние жесткие диски, камеры видеонаблюдения.
*   **Облачные хранилища и сервисы:** Данные из почтовых ящиков (Gmail, Outlook), облачных дисков (Google Drive, Yandex.Disk), социальных сетей.
*   **"Умные" устройства (Интернет вещей, IoT):** Данные с фитнес-браслетов, умных колонок, систем "умный дом", которые могут содержать информацию о действиях и местонахождении пользователя.

#### **2. По "летучести" (устойчивости):**

Это самая важная для следователя классификация, определяющая порядок сбора.

*   **Летучие данные (Volatile Data):**
    *   **Что это?** Данные, которые существуют только во время работы устройства и безвозвратно теряются при его выключении или перезагрузке.
    *   **Примеры:**
        *   Содержимое оперативной памяти (RAM)
        *   Список запущенных процессов
        *   Активные сетевые подключения
        *   Открытые порты
        *   Данные в кэше процессора
    *   **Правило сбора:** Собираются в **первую очередь**, по принципу "от наиболее летучих к наименее летучим".

*   **Нелетучие данные (Persistent Data):**
    *   **Что это?** Данные, которые сохраняются на постоянном носителе (жесткий диск, SSD, флешка) и не зависят от подачи питания.
    *   **Примеры:** Фотографии, документы, файлы операционной системы, базы данных, журналы событий.
    *   **Правило сбора:** Собираются после летучих данных. Основной метод — создание битовой копии (образа).

---

### **Часть 2: Характеристики цифровых улик (Требования к доказательствам)**

Чтобы цифровая улика была принята судом, она должна обладать тремя ключевыми характеристиками:

1.  **Достоверность (Authenticity)**
    *   **Что это?** Необходимо доказать, что улика является подлинной и именно той, за которую ее выдают. Не должно быть сомнений в ее происхождении и содержании.
    *   **Как обеспечить?**
        *   Фиксация хэш-сумм (MD5, SHA-256) оригинала и копии. Совпадение хэшей доказывает, что данные не изменялись.
        *   Подробное документирование всего процесса: кто, когда, где и с помощью чего извлек улику.

2.  **Целостность (Integrity)**
    *   **Что это?** Гарантия того, что с момента изъятия улика не была изменена, повреждена или уничтожена.
    *   **Как обеспечить?**
        *   Работа **только с копией**. Оригинальный носитель изымается и хранится в безопасном месте.
        *   Использование аппаратно-программных комплексов, которые блокируют возможность записи на исходный носитель (криминалистические стационарные комплексы Tableau, криминалистические карты-блокираторы).
        *   Расчет и проверка хэш-сумм на каждом этапе работы с копией.

3.  **Допустимость (Admissibility)**
    *   **Что это?** Юридическое требование, означающее, что улика была получена законным путем и может быть представлена в суде.
    *   **Как обеспечить?**
        *   Строгое соблюдение **процессуальных норм** (например, получение санкции на обыск или выемку).
        *   Соблюдение **цепи сохранности**.

---

### **Часть 3: Правила сбора и сохранения. Цепь сохранности.**

**Цепь сохранности (Chain of Custody)** — это документально зафиксированная история всех лиц, которые имели доступ к вещественному доказательству, с момента его обнаружения до момента представления в суде. Это главный инструмент обеспечения целостности и допустимости.

#### **Этапы цепи сохранности:**

1.  **Обнаружение и изъятие:**
    *   Фотографирование или видеозапись расположения устройства в момент изъятия.
    *   Запись серийных номеров, моделей.
    *   Упаковка носителей в специальные антистатические пакеты, опечатывание.

2.  **Транспортировка и хранение:**
    *   Передача изъятых материалов под роспись ответственному лицу.
    *   Хранение в защищенном месте с ограниченным доступом (сейф).

3.  **Анализ в лаборатории:**
    *   Работа только с битовой копией (образом) носителя.
    *   Проверка и запись хэш-сумм перед началом анализа и после его завершения.
    *   Все действия с образом должны быть документированы и воспроизводимы.

#### **Практические правила сбора:**

**Правило 1: Не навреди (The Principle of Least Irreversible Change)**
Любое ваше действие должно вносить минимальные изменения в исходные данные. Если изменения  (например, при изъятии летучих данных), они должны быть документированы и обоснованы.

**Правило 2: Соблюдай порядок сбора по степени летучести**
1.  Оперативная память (RAM).
2.  Сетеые соединения и активные процессы.
3.  Временные файлы и данные кэша.
4.  Постоянные данные на дисках.

**Правило 3: Всегда создавай битовую копию (Bit-by-Bit Image)**
*   **Обычное копирование:** Копирует только видимые файлы. Удаленные файлы, содержимое неразмеченного пространства, данные в файле подкачки останутся за бортом.
*   **Битовая копия:** Создает посекторную копию всего носителя, включая загрузочные записи, удаленные файлы (пока они не перезаписаны) и служебные области. Это "слепок" диска на момент изъятия.

**Правило 4: Документировать ВСЁ**
Записывается каждый шаг: какая команда была запущена, какая программа использовалась, какие результаты были получены, кто был свидетелем. Журнал должен быть настолько подробным, чтобы другой эксперт мог повторить ваши действия и получить тот же результат.

---

### **Итог: Алгоритм действий криминалиста**

1.  **Оценить сцену:** Определить источники цифровых улик и их состояние (включены/выключены).
2.  **Составить план сбора:** Определить порядок сбора, начиная с самых летучих данных.
3.  **Собрать летучие данные** с работающих систем.
4.  **Отключить питание** (если это допустимо и не противоречит цели расследования). Для мобильных телефонов использовать экраны Фарадея, чтобы заблокировать сетевые сигналы и дистанционное стирание.
5.  **Изъять и упаковать** физические носители, опечатать, заполнить начало цепи сохранности.
6.  **В лабораторных условиях** создать битовые образы изъятых носителей.
7.  **Рассчитать хэш-суммы** оригиналов и образов, зафиксировать их в документах.
8.  **Проводить анализ только с образами**, регулярно проверяя их целостность.

Соблюдение этих принципов превращает хрупкие цифровые данные в надежные и неопровержимые улики, способные выстоять в суде.


---

### **Осмотр места происшествия: работа с включенными и выключенными устройствами. "Порядок волатильности"**

#### **Введение: Цель осмотра**

Цель осмотра места происшествия (МП) с цифровыми устройствами — идентифицировать, сохранить и собрать все потенциальные источники цифровых улик, обеспечив их **целостность, достоверность и допустимость** для последующего анализа и, возможно, суда. Первые действия на месте являются самыми критическими и определяют успех всего расследования.

---

### **Часть 1: Первоначальная оценка и документирование сцены**

Прежде чем прикасаться к чему-либо, необходимо:

1.  **Обеспечить безопасность и изолировать область:** Никто не должен иметь доступ к компьютерам и другим устройствам.
2.  **Провести визуальную оценку:** Быстро, но тщательно осмотреть помещение и зафиксировать:
    *   **Все электронные устройства:** Ноутбуки, настольные ПК, мониторы (включен/выключен?), серверы, мобильные телефоны, планшеты, маршрутизаторы, USB-накопители, внешние диски.
    *   **Сопутствующие артефакты:** Записные книжки, стикеры с паролями, документы, кабели.
3.  **Фотографирование и видеосъемка:** Задокументировать общий план помещения и **детальные снимки** каждого устройства:
    *   Состояние питания (индикаторы горят/мигают?).
    *   Подключенные кабели (сетевые, периферийные).
    *   Состояние экрана (какие программы/окна открыты?).
    *   Серийные номера и модели устройств.

Эта документация создает "моментальный снимок" сцены и помогает впоследствии восстановить исходное состояние.

---

### **Часть 2: Ключевое решение — работать с включенным или выключенным устройством?**

Это самое важное решение, которое принимается на месте. Оно зависит от состояния устройства и контекста инцидента.

#### **Сценарий А: Устройство ВЫКЛЮЧЕНО**

**Действия:** Если устройство выключено, **НЕ ВКЛЮЧАЙТЕ ЕГО!**

*   **Почему?** Включение устройства приведет к изменению сотен тысяч временных меток файлов, записей в реестре и журналов. Это безвозвратно повредит оригинальные данные.
*   **Что делать?**
    1.  **Физически изъять носители информации:** Аккуратно извлеките жесткий диск (HDD/SSD) из системного блока или ноутбука.
    2.  **Заблокируйте запись:** Подключите изъятый носитель к криминалистическому станции с помощью **аппаратного блокиратора записи (write blocker)**. Это устройство пропускает данные на чтение, но физически не позволяет записывать что-либо на исходный диск.
    3.  **Создайте битовый образ:** Сделайте посекторную копию (битовый образ) диска с помощью криминалистического ПО (FTK Imager, Guymager, dd).
    4.  **Рассчитайте хэш-суммы:** Рассчитайте криптографические хэши (например, SHA-256) для оригинального диска и созданного образа. Их совпадение доказывает, что образ является точной копией.
    5.  **Все дальнейшие действия проводите только с ОБРАЗОМ,** а оригинальный диск поместите в доказательственный пакет и опечатайте.

#### **Сценарий Б: Устройство ВКЛЮЧЕНО**

Это более сложный сценарий, требующий осторожности и приоритизации по **"Порядку волатильности"**.

**Почему это сложно?** Включенное устройство содержит **летучие (волатильные) данные** в оперативной памяти (RAM), которые будут безвозвратно утеряны при выключении. Эти данные часто являются "золотым дном" для расследования.

**Первоначальные наблюдения (без прикосновения к устройствам):**
*   **Зафиксируйте состояние экрана:** Сфотографируйте все открытые окна, программы, сообщения об ошибках, активные сессии пользователей.
*   **Определите тип системы:** Является ли это критическим сервером, рабочим местом пользователя, файловым хранилищем? От этого зависит стратегия.

---

### **Часть 3: "Порядок волатильности" (Order of Volatility)**

Это фундаментальный принцип компьютерной криминалистики, который диктует **последовательность сбора улик от самых хрупких и легко теряемых к самым стабильным.**

**Обоснование:** Некоторые данные существуют доли секунды, другие годами хранятся на диске. Мы должны сначала собрать то, что может быть утеряно в первую очередь.

#### **Иерархия волатильности (от наиболее к наименее волатильным):**

1.  **Регистры и кэш процессора** (изменяются наносекунды) – практически не подлежат извлечению в стандартных условиях.
2.  **Оперативная память (RAM)** – **САМЫЙ ВАЖНЫЙ ОБЪЕКТ** для работающей системы. Содержит:
    *   Полные пароли и ключи шифрования (часто в незашифрованном виде).
    *   Активные сессии пользователей и токены аутентификации.
    *   Запущенные процессы (включая руткиты и вредоносные программы, которых нет на диске).
    *   Открытые документы и содержимое буфера обмена.
    *   Установленные сетевые подключения.
3.  **Сетевые соединения и таблицы маршрутизации:** Список активных подключений, ARP-кэш, таблицы маршрутизации. Помогает установить связь с другими системами.
4.  **Временные файлы и кэш приложений:** Данные, которые программы хранят для быстрого доступа (кэш браузера, временные файлы Word).
5.  **Жесткие диски / SSD (постоянные данные):** Данные, которые сохраняются при выключении питания.
6.  **Резервные копии и архивные носители:** Данные на лентах, DVD и т.д. Наименее волатильны.

---

### **Часть 4: Практический алгоритм действий для ВКЛЮЧЕННОГО устройства**

Действуйте строго по порядку волатильности:

**Шаг 0: Принятие решения о изъятии**
Решите, будете ли вы изымать только данные или все физическое устройство. Для серверов часто изымают только данные.

**Шаг 1: Сбор данных оперативной памяти (RAM)**
*   **Инструменты:** Используйте надежные, проверенные инструменты, которые минимизируют воздействие на систему (Magnet RAM Capture, Belkasoft Live RAM Capturer, инструменты из набора Velociraptor).
*   **Процесс:** Скопируйте исполняемый файл сборщика на внешний USB-накопитель. Запустите его на исследуемой машине. Сохраните дамп памяти на внешний носитель. **Никогда не сохраняйте на сам исследуемый компьютер!**
*   **Фиксация:** Рассчитайте хэш-сумму полученного файла дампа.

**Шаг 2: Сбор летучих системных данных**
*   Одновременно с дампом памяти или сразу после него соберите другую критическую информацию с помощью консольных команд или скриптов:
    *   `netstat -an` → список сетевых подключений и открытых портов.
    *   `tasklist /v` или `ps` → список запущенных процессов.
    *   `ipconfig /all` или `ifconfig` → сетевая конфигурация.
    *   `arp -a` → ARP-таблица.
    *   Результаты команд сохраните на внешний носитель.

**Шаг 3: Завершение работы и физическое изъятие**
*   **После сбора всех летучих данных** необходимо решить, как завершить работу.
    *   **Предпочтительный метод (для сохранения данных на диске в неизменном виде):** Обесточьте систему. Для ПК – выдерните шнур из розетки. Для ноутбука – извлеките аккумулятор. Это предотвращает срабатывание механизмов "уничтожения данных при выключении".
    *   **Альтернативный метод (если система критична и требуется корректное завершение):** Используйте криминалистический загрузочный Live-CD/USB (например, Caine, Paladin). Он позволит корректно смонтировать диски и создать их образы, не загружая операционную систему с жесткого диска, что предотвратит изменение данных.

**Шаг 4: Обращение с устройством как с ВЫКЛЮЧЕННЫМ**
*   После отключения питания действуйте по алгоритму для выключенных устройств: извлеките носители, подключите через блокиратор записи, создайте битовый образ.

---

### **Итог: Сводная таблица действий**

| Состояние устройства | Первоочередное действие | Последующие действия | Риски |
| :--- | :--- | :--- | :--- |
| **ВЫКЛЮЧЕНО** | **НЕ ВКЛЮЧАТЬ!** | 1. Физическое изъятие диска. <br>2. Создание образа через write blocker. | Потеря летучих данных. Минимальный риск повреждения постоянных данных. |
| **ВКЛЮЧЕНО** | 1. Сфотографировать экран. <br>2. **Собрать дамп RAM** и летучие данные. | 1. Обесточить (или использовать Live-CD). <br>2. Действовать как с выключенным устройством. | Высокий риск потери летучих данных при ошибке. Риск запуска механизмов уничтожения данных. |

**Главный принцип:** Ваши действия должны быть **обоснованными, документированными и направленными на сохранение наиболее хрупких доказательств в первую очередь**. Следование "Порядку волатильности" — это не просто рекомендация, это профессиональный стандарт, обеспечивающий успех расследования.


---

### **Создание криминалистических копий (образов). Побитовое копирование. Форматы образов**

#### **Введение: Почему нельзя работать с оригиналом?**

Первый и главный принцип компьютерной криминалистики: **Никогда не работать с оригинальными носителями-уликами.** Любое действие — от простого просмотра файла до загрузки операционной системы — вносит изменения в данные, нарушая их целостность и делая улики недопустимыми в суде.

**Решение:** Создание точной, полной копии исходного носителя, с которой и будет вестись вся дальнейшая работа. Эта копия называется **криминалистическим образом**.

---

### **Часть 1: Побитовое копирование (Bit-by-Bit Imaging)**

**Побитовое (посекторное) копирование** — это процесс создания точной, побайтной копии *всего* исходного носителя, от первого до последнего сектора.

#### **Что копируется при побитовом копировании?**

*   **Файлы и папки** (пользовательские и системные).
*   **Загрузочные записи (MBR, GPT).**
*   **Таблицы разделов.**
*   **Удаленные файлы** (пока они не перезаписаны новыми данными).
*   **Свободное и неразмеченное пространство** (slack space, unallocated space), где могут храниться фрагменты удаленных файлов, данные из кэша и другие артефакты.
*   **Служебные области диска,** не доступные для просмотра стандартными средствами ОС.

**Аналогия:**
Представьте себе книгу.
*   **Обычное копирование (копирование файлов)** — это как переписать только основной текст глав, которые сейчас открыты. Предисловие, оглавление, пометки на полях, вырванные страницы, карандашные пометки будут потеряны.
*   **Побитовое копирование** — это как отсканировать книгу целиком, от обложки до обложки, включая все пустые страницы, пометки, следы использования. Вы получаете ее полный цифровой двойник.

#### **Ключевые характеристики побитового образа:**

1.  **Полнота:** Образ содержит 100% данных исходного носителя.
2.  **Точность:** Данные копируются без изменений.
3.  **Верифицируемость:** Целостность образа можно проверить с помощью криптографических хэш-функций.

---

### **Часть 2: Процесс создания криминалистического образа**

Это строгий, документированный процесс, обеспечивающий допустимость улик.

**Шаг 1: Подготовка и изоляция исходного носителя**
*   Оригинальный диск (HDD/SSD) изымается из компьютера.
*   **Важно:** Для предотвращения случайной записи данных исходный носитель подключается к рабочей станции криминалиста через **аппаратный или программный блокиратор записи (Write Blocker)**. Это устройство физически или логически блокирует любые команды записи на исходный диск.

**Шаг 2: Подготовка целевого носителя**
*   Целевой носитель (чистый HDD/SSD или файловое хранилище) должен быть по объему равен или больше исходного.

**Шаг 3: Создание образа с помощью криминалистического ПО**
*   Используется специализированное ПО (FTK Imager, Guymager, X-Ways, dd).
*   Процесс запускается, и инструмент начинает посекторное копирование.

**Шаг 4: Расчет и проверка хэш-сумм — самый важный шаг**
*   **Хэш-сумма (контрольная сумма)** — это уникальный цифровой "отпечаток" данных, вычисленный по алгоритму (чаще всего MD5 или SHA-256).
*   **Процесс:**
    1.  Перед началом копирования вычисляется хэш **исходного носителя**.
    2.  После завершения копирования вычисляется хэш **созданного образа**.
    3.  Хэши **должны полностью совпасть**. Это математически доказывает, что образ является точной, неизмененной копией оригинала.
*   Эти хэши записываются в протокол и сопровождают образ на всех этапах, являясь главным доказательством его целостности.

---

### **Часть 3: Форматы криминалистических образов**

Существуют разные форматы для хранения образов. У каждого свои преимущества.

#### **1. RAW-образ (формат `dd`)**

*   **Что это?** Самый простой и "сырой" формат. Это буквально поток битов, скопированных с диска, сохраненный в файл без какой-либо дополнительной структуры или метаданных.
*   **Расширения файлов:** `.dd`, `.img`, `.raw`, `.001`
*   **Преимущества:**
    *   **Универсальность:** Может быть прочитан и создан практически любым криминалистическим инструментом, включая бесплатные утилиты (например, сама утилита `dd` в Linux).
    *   **Скорость:** Процесс создания обычно быстрее, так как нет накладных расходов на сжатие или шифрование.
*   **Недостатки:**
    *   **Отсутствие метаданных:** Файл образа не содержит внутри себя информации о случае, следователе, хэш-суммах оригинала. Эти данные должны храниться отдельно в протоколе.
    *   **Нет сжатия:** Занимает столько же места, сколько исходный диск (например, образ диска на 1 ТБ займет 1 ТБ).
    *   **Нет целостности "на лету":** Если файл образа повредится, вы не узнаете об этом, пока не попытаетесь его открыть.

#### **2. Экспертный образ (формат `E01` / EnCase Evidence File)**

*   **Что это?** Продвинутый формат, разработанный компанией Guidance Software (ныне OpenText) для своего пакета EnCase. Является отраслевым стандартом.
*   **Структура E01-файла:**
    1.  **Заголовок (Header):** Содержит служебную информацию о случае: номер дела, имя следователя, описание улики, дату изъятия и т.д.
    2.  **Блоки сжатых данных:** Данные диска разбиваются на блоки (обычно 64 Кб) и сжимаются. Это позволяет экономить место на целевом носителе.
    3.  **Циклический контроль избыточности (CRC):** После каждого блока данных записывается его контрольная сумма. Это позволяет постоянно проверять целостность образа при работе с ним.
    4.  **Заключительная часть (Footer):** Содержит хэш-суммы **оригинального диска** (MD5/SHA-1), рассчитанные в момент создания образа.
*   **Преимущества:**
    *   **Встроенные метаданные:** Вся информация о деле хранится внутри файла образа.
    *   **Сжатие данных:** Экономит место для хранения.
    *   **Встроенная проверка целостности:** При каждом открытии образа проверяются CRC-суммы каждого блока. Любое повреждение будет немедленно обнаружено.
    *   **Защита от изменений:** Файл образа доступен только для чтения.
*   **Недостатки:**
    *   **Проприетарный формат:** Изначально создан для EnCase, хотя сейчас поддерживается большинством современных инструментов (FTK, X-Ways, Autopsy).
    *   **Скорость:** Процесс создания образа медленнее из-за сжатия и расчета CRC.

#### **3. Другие форматы (AFF, ASR)**

*   **AFF (Advanced Forensic Format):** Открытый, некоммерческий формат, сочетающий преимущества `dd` и `E01` (метаданные, сжатие, целостность).
*   **ASR (Aware Serialized Report):** Собственный формат для отечественного криминалистического ПО.

---

### **Сравнительная таблица форматов**

| Критерий | **RAW (dd)** | **Expert Witness (E01)** |
| :--- | :--- | :--- |
| **Размер** | Равен размеру исходного диска | Меньше за счет сжатия |
| **Скорость создания** | Высокая | Ниже из-за сжатия и расчетов |
| **Метаданные** | Отсутствуют (хранятся отдельно) | Встроены в файл образа |
| **Проверка целостности** | Только при сравнении хэшей | Постоянная, при каждом открытии (CRC) |
| **Универсальность** | Читается всеми инструментами | Читается большинством современных инструментов |
| **Использование** | Быстрое создание, обмен данными | Долгосрочное хранение, основные расследования |

### **Итог**

Создание криминалистического образа — это не просто "копирование диска". Это строгий, научно обоснованный процесс, целью которого является создание **законной, достоверной и неизменной копии цифровых улик**. Выбор между форматами `dd` и `E01` является стратегическим: `dd` — для скорости и универсальности, `E01` — для надежности, долговечности и полноты документации в рамках серьезного расследования.


---

### **Антифорензика: техники сокрытия и уничтожения следов**

#### **Введение: Что такое антифорензика?**

**Антифорензика (Anti-Forensics)** — это совокупность методов, инструментов и методологий, направленных на противодействие компьютерно-криминалистическому расследованию. Цели антифорензики:
1.  **Затруднить или сделать невозможным** сбор цифровых улик.
2.  **Уничтожить доказательства** противоправной деятельности.
3.  **Ввести следователя в заблуждение** или заставить его потратить неоправданно много времени и ресурсов.
4.  **Снизить качество и достоверность** собранных улик, чтобы сделать их непригодными для суда.

Антифорензика — это постоянная "гонка вооружений" между злоумышленниками и криминалистами.

---

### **Часть 1: Стирание данных (Data Wiping)**

**Цель:** Безвозвратное уничтожение данных, делающее их восстановление невозможным.

**Проблема:** Простое удаление файла или даже форматирование диска не стирает сами данные. Стирается лишь ссылка на них (в MFT или таблице разделов). Данные остаются на диске до тех пор, пока не будут перезаписаны новой информацией.

**Методы:**

1.  **Физическое уничтожение:**
    *   **Размагничивание (Degaussing):** Воздействие на накопитель мощным магнитным полем, которое нарушает магнитную ориентацию частиц, безвозвратно разрушая все данные. Эффективно для HDD, но бесполезно для SSD и флеш-памяти.
    *   **Физическое разрушение:** Дробление, измельчение (шредирование) или сжигание дисков. Самый надежный метод.

2.  **Программное затирание (Software Wiping):**
    *   **Принцип:** Данные на диске многократно перезаписываются случайными последовательностями нулей и единиц.
    *   **Стандарты:** Существуют государственные и военные стандарты (например, DoD 5220.22-M, ГОСТ Р 50739-95, алгоритм Гутмана), которые предписывают определенное количество циклов перезаписи для гарантированного уничтожения.
    *   **Инструменты:** `shred` (Linux), `cipher /w` (Windows), DBAN (Darik's Boot and Nuke), CCleaner.
    *   **Сложность для SSD:** Из-за технологии выравнивания износа (wear leveling) и наличия резервных блоков операционная система не может напрямую контролировать, в какой физический блок данных будет произведена запись. Это делает программное затирание для SSD менее надежным. Надежнее всего для SSD — использование команды **ATA Secure Erase**, которая дает контроллеру диска команду на сброс всех ячеек памяти.

---

### **Часть 2: Шифрование (Encryption)**

**Цель:** Сделать данные нечитаемыми для любого, у кого нет ключа дешифрования. Даже если следователь получит физический носитель, он не сможет получить доступ к информации.

**Методы:**

1.  **Полное шифрование диска (FDE - Full Disk Encryption):**
    *   **Что это?** Шифруется весь диск, включая операционную систему, все файлы и временные файлы.
    *   **Примеры:** BitLocker (Windows), FileVault (macOS), LUKS (Linux), VeraCrypt.
    *   **Проблема для криминалиста:** При выключенном компьютере и правильно настроенном шифровании данные абсолютно недоступны. Криминалист не может создать образ диска для последующего анализа. Единственная надежда — найти ключ в оперативной памяти, если компьютер был захвачен в **работающем состоянии и заблокированном сеансе**.

2.  **Шифрование контейнеров и файлов:**
    *   **Что это?** Шифруются не весь диск, а отдельные файлы или создаются зашифрованные контейнеры (файлы-образы), которые выглядят как один большой файл.
    *   **Пример:** VeraCrypt позволяет создавать скрытые тома внутри зашифрованного контейнера, что позволяет отрицать само существование скрытых данных (plausible deniability).

**Антифорензик-аспект:** Современные алгоритмы шифрования (AES-256) практически невзламываемы методом грубой силы. Таким образом, шифрование смещает фокус расследования с анализа данных на **поиск ключа шифрования** (например, в дампе оперативной памяти, путем принуждения к его раскрытию или через социальную инженерию).

---

### **Часть 3: Стеганография (Steganography)**

**Цель:** Скрыть сам факт существования секретных данных, а не их содержание (в отличие от шифрования).

**Принцип:** Конфиденциальная информация (файл, текст, изображение) скрывается внутри другого, безобидного файла-контейнера (чаще всего — изображение, аудио- или видеофайл).

**Методы:**

*   **Для изображений:** Младшие биты каждого пикселя заменяются на биты секретного сообщения. Для человеческого глаза изменение настолько незначительно, что разницу между оригиналом и контейнером заметить невозможно.
*   **Пример:** В изображении размером 1024x768 пикселей с 24-битным цветом можно скрыть до ~236 КБ данных, абсолютно не изменив его визуальное восприятие.
**Проблема для криминалиста:**
1.  **Обнаружение (Steganalysis):** Требует специального ПО для статистического анализа файлов, которое ищет аномалии, характерные для внедрения данных (например, неестественное распределение цветов в изображении).
2.  **Масштаб:** Проверка всех файлов на носителе на предмет стеганографии — крайне трудоемкий и долгий процесс.
3.  **Извлечение:** Даже если факт стеганографии обнаружен, для извлечения данных часто требуется пароль.

---

### **Часть 4: Руткиты (Rootkits)**

**Цель:** Скрыть присутствие злоумышленника, вредоносного ПО или следов его деятельности в системе. Руткит не является вредоносной программой сам по себе, это механизм ее сокрытия.

**Принцип работы:** Руткит получает привилегии ядра операционной системы (kernel-mode) или глубоко внедряется в ее пользовательскую часть (user-mode) и начинает **лгать системе и приложениям**.

**Типы и методы:**

1.  **User-Mode Rootkits:**
    *   Подменяют системные библиотеки (DLL) или исполняемые файлы (например, `ps`, `ls`, `netstat` в Linux; диспетчер задач в Windows).
    *   Когда следователь запускает программу для просмотра процессов, руткит "фильтрует" вывод и не показывает вредоносный процесс.

2.  **Kernel-Mode Rootkits:**
    *   Внедряются непосредственно в ядро ОС.
    *   Могут скрывать файлы, процессы, сетевые соединения, драйверы на самом низком уровне.
    *   Обнаружить их сложнее, так они могут обмануть даже антивирусное ПО.

3.  **Bootkit:**
    *   Заменяет или модифицирует загрузчик ОС (MBR, UEFI).
    *   Активен еще до загрузки операционной системы, что позволяет ему контролировать весь процесс и быть крайне устойчивым.

4.  **Аппаратные руткиты (Hardware/Firmware Rootkits):**
    *   Внедряются в прошивку (firmware) устройств: сетевой карты, жесткого диска, BIOS/UEFI.
    *   Переживают переустановку ОС и форматирование диска. Обнаруживаются только с помощью специального оборудования и методов.

**Борьба с руткитами:**
*   **Анализ оперативной памяти (Memory Forensics):** Руткит, чтобы работать, должен находиться в ОЗУ. Инструменты вроде Volatility Framework могут анализировать дамп памяти и находить скрытые процессы, драйверы и сетевые соединения, так как в памяти руткит не может так же эффективно скрыть свою активность.
*   **Анализ на основе доверенной среды (Trusted Boot):** Сравнение хэш-сумм загрузчиков и системных файлов с эталонными.
*   **Загрузка с криминалистического Live-CD:** Позволяет обойти руткит, работающий внутри ОС, и проанализировать диск извне.

---

### **Итог: Значение для расследования**

Понимание техник антифорензики критически важно для современного криминалиста, потому что:

1.  **Требует более глубоких знаний:** Расследование уже не сводится к простому анализу файловой системы.
2.  **Смещает фокус:** Приходится больше полагаться на анализ оперативной памяти, сетевого трафика и артефактов, а не только на данные диска.
3.  **Подчеркивает важность скорости:** Чем быстрее будет изъято работающее устройство, тем выше шансы захватить ключи шифрования в памяти и обнаружить следы руткитов.
4.  **Делает процесс сложнее и дороже:** Обнаружение и обход этих техник требует времени, специальных инструментов и высокой квалификации.

Антифорензика — это мощный барьер, но не непреодолимая стена. Знание методов противника позволяет разрабатывать эффективные контрмеры и сохранять цифровые улики в целости для правосудия.

