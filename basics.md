
---

## **üåê –ú–û–î–£–õ–¨ 2.1: –°–ï–¢–ï–í–û–ô –£–†–û–í–ï–ù–¨ (IP) - –≠–ö–°–ü–ï–†–¢–ù–û–ï –†–ê–ó–û–ë–†–ê–ù–ò–ï**

### **1. –ü—Ä–æ—Ç–æ–∫–æ–ª IP (IPv4/IPv6): –§—É–Ω–¥–∞–º–µ–Ω—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**

#### **IPv4 - –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**

**–ó–∞–≥–æ–ª–æ–≤–æ–∫ IPv4 (20-60 –±–∞–π—Ç) - –î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä:**

```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Version|  IHL  |Type of Service|          Total Length         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Identification        |Flags|      Fragment Offset    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Time to Live |    Protocol   |         Header Checksum       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Source Address                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Destination Address                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Options                    |    Padding    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è:**

- **Version (4 –±–∏—Ç–∞):** `0100` = IPv4
- **IHL (Internet Header Length):** –î–ª–∏–Ω–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –≤ 32-–±–∏—Ç–Ω—ã—Ö —Å–ª–æ–≤–∞—Ö (–æ–±—ã—á–Ω–æ 5 = 20 –±–∞–π—Ç)
- **Type of Service (DSCP/ECN):** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–∞–∫–µ—Ç–∞ (–∫–∞—á–µ—Å—Ç–≤–æ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è)
- **Total Length:** –û–±—â–∞—è –¥–ª–∏–Ω–∞ –ø–∞–∫–µ—Ç–∞ (–∑–∞–≥–æ–ª–æ–≤–æ–∫ + –¥–∞–Ω–Ω—ã–µ), –º–∞–∫—Å–∏–º—É–º 65535 –±–∞–π—Ç
- **Identification:** –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è —Å–±–æ—Ä–∫–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤
- **Flags:** 
  - **DF (Don't Fragment):** –ó–∞–ø—Ä–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü–∏–∏
  - **MF (More Fragments):** –ï—Å—Ç—å –µ—â–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã
- **Fragment Offset:** –ü–æ–∑–∏—Ü–∏—è —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –ø–∞–∫–µ—Ç–µ
- **Time to Live (TTL):** "–°—Ä–æ–∫ –∂–∏–∑–Ω–∏" –ø–∞–∫–µ—Ç–∞. –£–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ 1 –Ω–∞ –∫–∞–∂–¥–æ–º –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–µ
- **Protocol:** –í—ã—à–µ–ª–µ–∂–∞—â–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª (6=TCP, 17=UDP, 1=ICMP)
- **Header Checksum:** –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è —Å—É–º–º–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
- **Source/Destination Address:** IP-–∞–¥—Ä–µ—Å–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª—è

#### **IP-–∞–¥—Ä–µ—Å–∞—Ü–∏—è: –û—Ç –æ—Å–Ω–æ–≤ –∫ —Å–ª–æ–∂–Ω–æ–º—É**

**–ö–ª–∞—Å—Å—ã —Å–µ—Ç–µ–π (—É—Å—Ç–∞—Ä–µ–≤—à–∞—è, –Ω–æ –≤–∞–∂–Ω–∞—è –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è):**

```
–ö–ª–∞—Å—Å A: 0.0.0.0 - 127.255.255.255    –ú–∞—Å–∫–∞: 255.0.0.0/8
–ö–ª–∞—Å—Å B: 128.0.0.0 - 191.255.255.255  –ú–∞—Å–∫–∞: 255.255.0.0/16  
–ö–ª–∞—Å—Å C: 192.0.0.0 - 223.255.255.255  –ú–∞—Å–∫–∞: 255.255.255.0/24
–ö–ª–∞—Å—Å D: 224.0.0.0 - 239.255.255.255  ( multicast)
–ö–ª–∞—Å—Å E: 240.0.0.0 - 255.255.255.255  (–∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ)
```

**–ú–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏ - –±–∏—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ:**

```
IP: 192.168.1.100     = 11000000.10101000.00000001.01100100
–ú–∞—Å–∫–∞: 255.255.255.0  = 11111111.11111111.11111111.00000000
AND –æ–ø–µ—Ä–∞—Ü–∏—è:
–°–µ—Ç—å: 192.168.1.0     = 11000000.10101000.00000001.00000000
```

**VLSM (Variable Length Subnet Mask) - –ø—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:**

–ò—Å—Ö–æ–¥–Ω–∞—è —Å–µ—Ç—å: `192.168.1.0/24`

| –ü–æ–¥—Å–µ—Ç—å | –¢—Ä–µ–±—É–µ—Ç—Å—è —Ö–æ—Å—Ç–æ–≤ | –ú–∞—Å–∫–∞ | –î–∏–∞–ø–∞–∑–æ–Ω | Broadcast |
|---------|------------------|-------|----------|-----------|
| –°–µ—Ä–≤–µ—Ä—ã | 50 —Ö–æ—Å—Ç–æ–≤ | /26 | 192.168.1.0-63 | 192.168.1.63 |
| –û—Ñ–∏—Å 1 | 25 —Ö–æ—Å—Ç–æ–≤ | /27 | 192.168.1.64-95 | 192.168.1.95 |
| –û—Ñ–∏—Å 2 | 10 —Ö–æ—Å—Ç–æ–≤ | /28 | 192.168.1.96-111 | 192.168.1.111 |
| –°–≤—è–∑–∏ | 2 —Ö–æ—Å—Ç–∞ | /30 | 192.168.1.112-115 | 192.168.1.115 |

**CIDR (Classless Inter-Domain Routing):**
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ç–µ–π –≤ –æ–¥–Ω—É —Å—É–ø–µ—Ä—Å–µ—Ç—å
- –ü—Ä–∏–º–µ—Ä: `192.168.0.0/22` = —Å–µ—Ç–∏ `192.168.0.0/24`, `192.168.1.0/24`, `192.168.2.0/24`, `192.168.3.0/24`

**–ü—É–±–ª–∏—á–Ω—ã–µ vs –ß–∞—Å—Ç–Ω—ã–µ –∞–¥—Ä–µ—Å–∞:**

```
–ß–∞—Å—Ç–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã:
10.0.0.0 - 10.255.255.255/8
172.16.0.0 - 172.31.255.255/12
192.168.0.0 - 192.168.255.255/16

–û—Å–æ–±—ã–µ –∞–¥—Ä–µ—Å–∞:
127.0.0.0/8 - localhost (–ø–µ—Ç–ª—è)
169.254.0.0/16 - APIPA (–∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
```

#### **IPv6 - –ü—Ä–æ—Ç–æ–∫–æ–ª –±—É–¥—É—â–µ–≥–æ**

**–ö–ª—é—á–µ–≤—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- **128-–±–∏—Ç–Ω—ã–µ –∞–¥—Ä–µ—Å–∞** vs 32-–±–∏—Ç–Ω—ã–µ –≤ IPv4
- **–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫** - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä 40 –±–∞–π—Ç
- **–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (IPsec)
- **–ê–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** –±–µ–∑ DHCP
- **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ NAT** (–≤ —á–∏—Å—Ç–æ–º –≤–∏–¥–µ)

**–§–æ—Ä–º–∞—Ç –∞–¥—Ä–µ—Å–∞ IPv6:**
```
2001:0db8:85a3:0000:0000:8a2e:0370:7334
```
**–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ:** `2001:db8:85a3::8a2e:370:7334`

**–¢–∏–ø—ã –∞–¥—Ä–µ—Å–æ–≤ IPv6:**
- **Unicast:** –û–¥–∏–Ω-–∫-–æ–¥–Ω–æ–º—É
- **Multicast:** –û–¥–∏–Ω-–∫–æ-–º–Ω–æ–≥–∏–º
- **Anycast:** –û–¥–∏–Ω-–∫-–±–ª–∏–∂–∞–π—à–µ–º—É

---

### **2. –ü—Ä–æ—Ç–æ–∫–æ–ª ICMP: "–°–∏–≥–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞" –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**

#### **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ ICMP**

ICMP (Internet Control Message Protocol) - –ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–± –æ—à–∏–±–∫–∞—Ö –∏ —Å–ª—É–∂–µ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ ICMP-–ø–∞–∫–µ—Ç–∞:**
```
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |          Checksum             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                             Data                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:**

| Type | Code | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| 0 | 0 | Echo Reply (–æ—Ç–≤–µ—Ç –Ω–∞ ping) |
| 3 | 0-15 | Destination Unreachable |
| 8 | 0 | Echo Request (–∑–∞–ø—Ä–æ—Å ping) |
| 11 | 0-1 | Time Exceeded (–¥–ª—è traceroute) |

#### **–£—Ç–∏–ª–∏—Ç–∞ PING - –¥–µ—Ç–∞–ª–∏ —Ä–∞–±–æ—Ç—ã**

**–ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `ping 8.8.8.8`:**

1. **–°–æ–∑–¥–∞–Ω–∏–µ ICMP Echo Request:**
```
Type: 8 (Echo Request)
Code: 0
Checksum: [—Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è]
Identifier: 1234 (ID –ø—Ä–æ—Ü–µ—Å—Å–∞)
Sequence: 1 (–Ω–æ–º–µ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
Data: [timestamp –∏–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ]
```

2. **–ò–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –≤ IP:**
```
Protocol: 1 (ICMP)
Source: 192.168.1.100
Destination: 8.8.8.8
TTL: 64
```

3. **–ü–æ–ª—É—á–µ–Ω–∏–µ ICMP Echo Reply:**
```
Type: 0 (Echo Reply)
Code: 0
Data: [—Ç–æ—Ç –∂–µ data —á—Ç–æ –∏ –≤ –∑–∞–ø—Ä–æ—Å–µ]
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```bash
$ ping 8.8.8.8
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: icmp_seq=0 ttl=117 time=15.432 ms
64 bytes from 8.8.8.8: icmp_seq=1 ttl=117 time=14.987 ms
```

#### **–£—Ç–∏–ª–∏—Ç–∞ TRACEROUTE - –∞–Ω–∞–ª–∏–∑ –ø—É—Ç–∏**

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã (–Ω–∞ –æ—Å–Ω–æ–≤–µ TTL):**

1. **–ü–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç:** TTL=1
   - –ü–µ—Ä–≤—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç TTL –¥–æ 0
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP Time Exceeded –æ–±—Ä–∞—Ç–Ω–æ
   - –ú—ã —É–∑–Ω–∞–µ–º –ø–µ—Ä–≤—ã–π —Ö–æ–ø

2. **–í—Ç–æ—Ä–æ–π –ø–∞–∫–µ—Ç:** TTL=2
   - –ü—Ä–æ—Ö–æ–¥–∏—Ç –ø–µ—Ä–≤—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä (TTL=1)
   - –í—Ç–æ—Ä–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä —É–º–µ–Ω—å—à–∞–µ—Ç TTL –¥–æ 0
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç ICMP Time Exceeded

3. **–ò —Ç–∞–∫ –¥–∞–ª–µ–µ...** –ø–æ–∫–∞ –ø–∞–∫–µ—Ç –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω–µ—Ç —Ü–µ–ª–∏

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```bash
$ traceroute google.com
 1  192.168.1.1   (192.168.1.1)  1.234 ms  1.123 ms  1.089 ms
 2  10.0.0.1      (10.0.0.1)     5.678 ms  5.543 ms  5.498 ms
 3  172.16.0.1    (172.16.0.1)   10.123 ms  10.098 ms  10.065 ms
 4  8.8.8.8       (8.8.8.8)      15.432 ms  15.398 ms  15.365 ms
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- **Windows:** `tracert` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ICMP
- **Linux:** `traceroute` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å UDP (–ø–æ—Ä—Ç—ã 33434-33534) –∏–ª–∏ ICMP

---

### **3. –ü—Ä–æ—Ç–æ–∫–æ–ª ARP –∏ –µ–≥–æ —É—è–∑–≤–∏–º–æ—Å—Ç–∏**

#### **–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã ARP**

ARP (Address Resolution Protocol) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç IP-–∞–¥—Ä–µ—Å–∞ –≤ MAC-–∞–¥—Ä–µ—Å–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å–µ—Ç–∏.

**ARP-—Ç–∞–±–ª–∏—Ü–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:**
```bash
$ arp -a
? (192.168.1.1) at 00:1a:2b:3c:4d:5e [ether] on eth0
? (192.168.1.100) at 00:a1:b2:c3:d4:e5 [ether] on eth0
```

**–ü—Ä–æ—Ü–µ—Å—Å ARP-–∑–∞–ø—Ä–æ—Å–∞:**

1. **–•–æ—Å—Ç A (192.168.1.10) —Ö–æ—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–∞–∫–µ—Ç —Ö–æ—Å—Ç—É B (192.168.1.20)**

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ ARP-–∫—ç—à–∞:** –ï—Å—Ç—å –ª–∏ MAC –¥–ª—è 192.168.1.20?

3. **–ï—Å–ª–∏ –Ω–µ—Ç - –æ—Ç–ø—Ä–∞–≤–∫–∞ ARP-–∑–∞–ø—Ä–æ—Å–∞ (broadcast):**
```
Frame:
Destination MAC: FF:FF:FF:FF:FF:FF (broadcast)
Source MAC: MAC_A

ARP Packet:
Hardware Type: Ethernet (1)
Protocol Type: IPv4 (0x0800)
Operation: Request (1)
Sender MAC: MAC_A
Sender IP: 192.168.1.10
Target MAC: 00:00:00:00:00:00 (unknown)
Target IP: 192.168.1.20
```

4. **–í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤ —Å–µ—Ç–∏ –ø–æ–ª—É—á–∞—é—Ç –∑–∞–ø—Ä–æ—Å, –Ω–æ –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Ü–µ–ª–µ–≤–æ–π —Ö–æ—Å—Ç:**

**ARP-–æ—Ç–≤–µ—Ç (unicast):**
```
Operation: Reply (2)
Sender MAC: MAC_B (—Ç–µ–ø–µ—Ä—å –∏–∑–≤–µ—Å—Ç–Ω–æ)
Sender IP: 192.168.1.20
Target MAC: MAC_A
Target IP: 192.168.1.10
```

#### **ARP Spoofing/Poisoning - –¥–µ—Ç–∞–ª–∏ –∞—Ç–∞–∫–∏**

**–°—É—Ç—å –∞—Ç–∞–∫–∏:** –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ª–æ–∂–Ω—ã–µ ARP-–æ—Ç–≤–µ—Ç—ã, —á—Ç–æ–±—ã –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Å–≤–æ–π MAC-–∞–¥—Ä–µ—Å —Å IP-–∞–¥—Ä–µ—Å–æ–º –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

**–°—Ü–µ–Ω–∞—Ä–∏–π –∞—Ç–∞–∫–∏:**
```
–ñ–µ—Ä—Ç–≤–∞: 192.168.1.10 (MAC: 00:11:22:33:44:55)
–®–ª—é–∑: 192.168.1.1 (MAC: AA:BB:CC:DD:EE:FF)
–ê—Ç–∞–∫—É—é—â–∏–π: 192.168.1.99 (MAC: 66:77:88:99:AA:BB)
```

**–®–∞–≥–∏ –∞—Ç–∞–∫–∏:**

1. **–û—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ ARP-–∫—ç—à–∞ –∂–µ—Ä—Ç–≤—ã:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∂–µ—Ä—Ç–≤–µ:
ARP Reply: "IP 192.168.1.1 –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ MAC 66:77:88:99:AA:BB"
```

2. **–û—Ç—Ä–∞–≤–ª–µ–Ω–∏–µ ARP-–∫—ç—à–∞ —à–ª—é–∑–∞:**
```
–ê—Ç–∞–∫—É—é—â–∏–π –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —à–ª—é–∑—É:
ARP Reply: "IP 192.168.1.10 –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ MAC 66:77:88:99:AA:BB"
```

3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ñ–µ—Ä—Ç–≤–∞ –¥—É–º–∞–µ—Ç, —á—Ç–æ —à–ª—é–∑ —ç—Ç–æ –∞—Ç–∞–∫—É—é—â–∏–π
- –®–ª—é–∑ –¥—É–º–∞–µ—Ç, —á—Ç–æ –∂–µ—Ä—Ç–≤–∞ —ç—Ç–æ –∞—Ç–∞–∫—É—é—â–∏–π
- –í–µ—Å—å —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∞—Ç–∞–∫—É—é—â–µ–≥–æ (**Man-in-the-Middle**)

#### **–ú–µ—Ç–æ–¥—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –∑–∞—â–∏—Ç—ã**

**1. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è ARP-—Ç–∞–±–ª–∏—Ü–∞ (—Ä—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞):**
```bash
# Linux
arp -s 192.168.1.1 00:1a:2b:3c:4d:5e

# Windows
arp -s 192.168.1.1 00-1a-2b-3c-4d-5e
```

**2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ arpwatch - –¥–µ—Ç–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

**–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
# Ubuntu/Debian
sudo apt install arpwatch

# CentOS/RHEL  
sudo yum install arpwatch
```

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫:**
```bash
# –ó–∞–ø—É—Å–∫ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
sudo arpwatch -i eth0

# –° —Ñ–ª–∞–≥–æ–º –æ—Ç–ª–∞–¥–∫–∏
sudo arpwatch -d -i eth0

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
sudo tail -f /var/log/arpwatch.log
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞ arpwatch –ø—Ä–∏ –∞—Ç–∞–∫–µ:**
```
Feb 15 10:30:15 arpwatch: flip flop 192.168.1.1 00:1a:2b:3c:4d:5e (AA:BB:CC:DD:EE:FF)
Feb 15 10:30:16 arpwatch: new station 192.168.1.1 66:77:88:99:aa:bb
Feb 15 10:30:17 arpwatch: changed ethernet address 192.168.1.1 00:1a:2b:3c:4d:5e -> 66:77:88:99:aa:bb
```

**3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã:**

**DHCP Snooping –Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–∞—Ö:**
```bash
# Cisco –ø—Ä–∏–º–µ—Ä
Switch(config)# ip dhcp snooping
Switch(config)# ip dhcp snooping vlan 1
Switch(config)# interface gigabitethernet0/1
Switch(config-if)# ip dhcp snooping trust
```

**Dynamic ARP Inspection (DAI):**
```bash
Switch(config)# ip arp inspection vlan 1
Switch(config)# interface range gigabitethernet0/2-24
Switch(config-if-range)# ip arp inspection limit rate 15
```

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é —Å–∫—Ä–∏–ø—Ç–æ–≤:**
```bash
#!/bin/bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ARP-—Ç–∞–±–ª–∏—Ü—ã
while true; do
    arp -an | grep -v incomplete | sort > current_arp.txt
    if [ -f prev_arp.txt ]; then
        diff prev_arp.txt current_arp.txt | grep ">" | while read line; do
            echo "ALERT: ARP change detected - $line"
            # –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        done
    fi
    mv current_arp.txt prev_arp.txt
    sleep 30
done
```

**4. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã:**

- **Port Security** –Ω–∞ –∫–æ–º–º—É—Ç–∞—Ç–æ—Ä–∞—Ö
- **802.1X** –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- **IP Source Guard**
- **–°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ç–∏** (VLAN)

---

### **üõ°Ô∏è –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ê–î–ú–ò–ù–ò–°–¢–†–ò–†–û–í–ê–ù–ò–Ø**

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ARP:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä ARP-—Ç–∞–±–ª–∏—Ü—ã
arp -a                    # Windows
arp -n                    # Linux/Mac

# –û—á–∏—Å—Ç–∫–∞ ARP-–∫—ç—à–∞
arp -d *                  # Windows
sudo ip neigh flush all   # Linux
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏:**
```bash
# –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π ping —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –º–µ—Ç–∫–∞–º–∏
ping -D 8.8.8.8          # Linux
ping -t 8.8.8.8          # Windows

# –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π traceroute
traceroute -I 8.8.8.8    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ICMP –≤–º–µ—Å—Ç–æ UDP
mtr 8.8.8.8              # –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
```

–≠—Ç–æ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª –¥–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Å–µ—Ç–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è - –æ—Ç —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –æ—Å–Ω–æ–≤ –¥–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏. –ö–∞–∂–¥—ã–π —Ä–∞–∑–¥–µ–ª –º–æ–∂–Ω–æ –∏–∑—É—á–∞—Ç—å –∏ –ø—Ä–∏–º–µ–Ω—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö —Å—Ä–µ–¥–∞—Ö.