

---

### 611. Атака CRIME (Compression Ratio Info-leak Made Easy)

**Объяснение:**
CRIME — это атака, которая использует уязвимости в механизмах сжатия данных (таких как DEFLATE, используемый в TLS/SSL и SPDY) для кражи конфиденциальной информации, например, куки аутентификации или токенов CSRF.

**Механизм атаки:**
1.  Злоумышленник может наблюдать за зашифрованным трафиком жертвы (например, находясь в одной сети).
2.  Он заставляет браузер жертвы отправлять множество запросов, в которые он подставляет предполагаемый секретный текст (например, `Cookie: session=abc123`).
3.  Если сжатие включено, и секретный текст совпадает с частью данных в запросе, общий размер сжатых данных будет меньше.
4.  Анализируя длину зашифрованных пакетов, злоумышленник может пошагово угадать содержимое секрета.

**Диаграмма последовательности CRIME:**

```mermaid
sequenceDiagram
    participant Злоумышленник
    participant Жертва
    participant Сервер

    Note over Злоумышленник: Этап 1: Наблюдение
    Жертва ->> Сервер: Зашифрованный запрос (длина = X байт)

    Note over Злоумышленник: Этап 2: Подстановка и анализ
    loop Для каждого символа в секрете
        Злоумышленник ->> Жертва: Внедряет скрипт, который<br>отправляет запрос с текстом: "Cookie: session=abc"
        Жертва ->> Сервер: Зашифрованный запрос (с подставленным текстом)
        Злоумышленник ->> Злоумышленник: Измеряет длину пакета
        alt Длина пакета уменьшилась
            Note right of Злоумышленник: Угадан символ!<br>Текст "abc" является частью куки.
        else Длина не изменилась
            Note right of Злоумышленник: Не угадал,<br>пробует следующий символ.
        end
    end
```

**Меры противодействия:**
*   **Отключить сжатие TLS** на сервере.
*   Использовать современные протоколы, такие как HTTP/2 и TLS 1.3, которые были разработаны с учетом уязвимостей типа CRIME.

---

### 612. Атака Forbidden

**Объяснение:**
Строго говоря, "Forbidden" — это не конкретная атака, а HTTP-статус ответа `403 Forbidden`, который сервер возвращает, когда доступ к ресурсу запрещен. Однако в контексте пентеста или поиска уязвимостей "атакой Forbidden" могут называть попытку обойти механизмы авторизации для доступа к ресурсам, которые должны возвращать статус 403.

**Механизм "атаки":**
1.  Злоумышленник, имея учетную запись с низкими привилегиями, пытается получить доступ к ресурсам, предназначенным для администраторов или других пользователей (например, прямая ссылка на чужой профиль `/admin/panel` или `/users/123/edit`).
2.  Если система неправильно проверяет права доступа на стороне сервера (т.н. "Broken Access Control"), вместо кода 403 злоумышленник может получить доступ к данным или функционалу.

**Меры противодействия:**
*   Строгая проверка прав доступа **на стороне сервера** для каждого запроса.
*   Принцип минимальных привилегий.
*   Регулярный аудит кода и пентест систем авторизации.

---

### 613. Перехват на сетевом уровне

**Объяснение:**
Это общее понятие, обозначающее перехват сетевых пакетов по мере их передачи через сетевые устройства (коммутаторы, маршрутизаторы). Это основа для многих других атак.

**Механизм атаки:**
*   Использование программ-снифферов (например, Wireshark, tcpdump) для прослушивания сетевого интерфейса.
*   Если сеть построена на хабах (концентраторах), весь трафик широковещательный, и его может прослушать любой узел в сегменте сети.
*   В современных сетях на коммутаторах для этого требуются специальные техники, такие как ARP Spoofing (см. ниже) или наводнение MAC-таблицы.

**Меры противодействия:**
*   **Шифрование трафика:** HTTPS, SSH, VPN. Это делает перехваченные данные бесполезными без ключа дешифрования.
*   Сегментация сети (VLAN).
*   Использование защищенных протоколов, таких как ARP с динамической защитой (DAI) на коммутаторах.

---

### 614. Перехват TCP/IP (TCP Session Hijacking)

**Объяснение:**
Атака, при которой злоумышленник "вмешивается" в установленное TCP-соединение между двумя узлами, чтобы перехватить его и выдать себя за одного из участников.

**Механизм атаки:**
1.  Злоумышленник отслеживает трафик между Клиентом и Сервером, чтобы узнать номера последовательности (Sequence Numbers) и подтверждения (ACK) пакетов.
2.  Используя эти данные, он отправляет на Сервер поддельный TCP-пакет с IP-адресом Клиента и правильным номером последовательности.
3.  Сервер, получив пакет с ожидаемым номером последовательности, принимает его и отправляет ответ. Если злоумышленник правильно предсказал номер, он может "перехватить" сессию и начать отправлять данные от имени Клиента.

**Диаграмма последовательности Перехвата TCP/IP:**

```mermaid
sequenceDiagram
    participant Клиент
    participant Злоумышленник
    participant Сервер

    Note left of Клиент: Легитимная сессия
    Клиент ->> Сервер: [SYN] Seq=X
    Сервер ->> Клиент: [SYN, ACK] Seq=Y, ACK=X+1
    Клиент ->> Сервер: [ACK] Seq=X+1, ACK=Y+1
    Клиент ->> Сервер: [PSH, ACK] Seq=X+1, ACK=Y+1, Data='Hello'

    Note over Злоумышленник: Начинает атаку
    Злоумышленник ->> Сервер: [PSH, ACK] Seq=X+6, ACK=Y+1, Data='EVIL CMD'<br>(IP подменен на IP Клиента)
    Сервер ->> Клиент: [ACK] Seq=Y+1, ACK=X+14
    Note left of Клиент: Клиент получает пакет<br>с неожиданным ACK номером<br>и разрывает соединение (RST).
    Клиент ->> Сервер: [RST] Seq=X+1
    Note over Сервер: Сессия нарушена.<br>Злоумышленник может<br>полностью ее перехватить.
```

**Меры противодействия:**
*   Использование **шифрования на транспортном или прикладном уровне** (TLS, SSH). Это основная мера.
*   Сложные, случайные начальные номера последовательностей (ISN) в TCP-стеке операционных систем.

---

### 615. IP спуфинг (IP Spoofing)

**Объяснение:**
Создание IP-пакетов с поддельным исходным IP-адресом с целью сокрытия идентификации отправителя или имитации другого компьютера.

**Механизм атаки:**
Злоумышленник вручную создает пакет, в поле "Source IP Address" которого указывает адрес жертвы, а не свой собственный. Это используется как компонент для других атак:
*   **Атаки типа "отказ в обслуживании" (DoS):** чтобы скрыть источник атаки или чтобы ответы от сервера шли на IP-адрес жертвы, усиливая атаку.
*   **Обход контроля доступа по IP.**

**Меры противодействия:**
*   **Входная фильтрация (Ingress Filtering)** на маршрутизаторах провайдеров: отбрасывание пакетов, поступающих из внешней сети, с исходным IP, принадлежащим внутренней сети.
*   **Выходная фильтрация (Egress Filtering):** отбрасывание пакетов, исходящих из внутренней сети, с исходным IP, не принадлежащим этой сети.
*   Использование IPsec.

---

### 616. Подделка RST (RST Injection / TCP Reset Attack)

**Объяснение:**
Атака, при которой злоумышленник отправляет поддельный пакет с флагом RST (reset) для принудительного разрыва установленного TCP-соединения.

**Механизм атаки:**
1.  Злоумышленник наблюдает за соединением между Клиентом и Сервером.
2.  Он создает пакет с флагом RST, правильными номерами последовательности и IP-адресом одного из участников.
3.  Получив такой пакет, узел считает, что его корреспондент разорвал соединение, и закрывает свою сторону сессии.

**Диаграмма последовательности Подделки RST:**

```mermaid
sequenceDiagram
    participant Клиент
    participant Злоумышленник
    participant Сервер

    Клиент ->> Сервер: Установленное TCP-соединение
    Note over Злоумышленник: Обнаруживает активное соединение
    Злоумышленник ->> Сервер: [RST] Seq=Z (поддельный номер)<br>(IP подменен на IP Клиента)
    alt Если номер последовательности Z корректен
        Сервер ->> Сервер: Немедленно разрывает соединение
        Сервер ->> Клиент: [RST] (в ответ на след. пакет Клиента)
        Note left of Клиент: Соединение разорвано
    else Если номер некорректен
        Сервер ->> Сервер: Игнорирует пакет
        Note over Атака: Не удалась
    end
```

**Меры противодействия:**
*   Шифрование (TLS) защищает от наблюдения за номерами последовательностей.
*   Использование более сложных и случайных ISN делает предсказание номера сложным.

---

### 617. Перехват вслепую (Blind Hijacking)

**Объяснение:**
Разновидность перехвата сессии, когда злоумышленник не может видеть трафик между жертвами (например, он находится в другой сети), но может отправлять им поддельные пакеты.

**Механизм атаки:**
Злоумышленник отправляет пакеты с предсказанными или угаданными номерами последовательностей. Если ему это удается, он может внедрить свои команды в сессию, не видя ответов. Это сложнее, чем классический перехват, так как требует точного угадывания номеров последовательностей.

**Меры противодействия:**
*   Все те же, что и для перехвата TCP/IP: шифрование и надежные ISN.

---

### 618. Перехват UDP (UDP Session Hijacking)

**Объяснение:**
Аналогичен перехвату TCP, но проще, поскольку UDP — это протокол без установления соединения и без состояний. В нем нет номеров последовательности.

**Механизм атаки:**
1.  Злоумышленник наблюдает за UDP-трафиком (например, DNS, VoIP).
2.  Он просто отправляет поддельный UDP-пакет на сервер, используя IP-адрес и порт жертвы, до того как жертва отправит свой следующий пакет.
3.  Сервер принимает пакет злоумышленника как легитимный и обрабатывает его.

**Меры противодействия:**
*   Шифрование UDP-трафика (например, с помощью DTLS, VPN).
*   Использование механизмов аутентификации на прикладном уровне.

---

### 619. Подделка ICMP

**Объяснение:**
Использование протокола ICMP (например, для ping или сообщений об ошибках) для проведения атак.

**Механизм атаки:**
*   **ICMP Redirect:** отправка поддельного сообщения "ICMP Redirect", чтобы заставить жертву использовать маршрутизатор злоумышленника для определенного трафика.
*   **Smurf-атака:** отправка ping-запросов на широковещательный адрес сети с подменой IP-адреса отправителя на адрес жертвы. Все хочи в сети отвечают жертве, вызывая DoS.
*   **Ping of Death:** отправка фрагментированного ping-пакета, который после сборки превышает максимальный размер, что приводит к сбою системы.

**Меры противодействия:**
*   Фильтрация входящих ICMP-пакетов на маршрутизаторе.
*   Отключение обработки ICMP-редиректов на хостах.
*   Запрет ответа на широковещательные ping-запросы.

---

### 620. ARP спуфинг (ARP Poisoning)

**Объяснение:**
Это ключевая атака для перехвата трафика в локальной сети (LAN). Она позволяет связать MAC-адрес злоумышленника с IP-адресом другого узла (например, шлюза по умолчанию).

**Механизм атаки:**
1.  В локальной сети коммутатор отправляет кадры на порт, соответствующий MAC-адресу получателя.
2.  Злоумышленник рассылает поддельные ARP-ответы (без ARP-запроса), объявляя: "IP-адрес шлюза (192.168.1.1) имеет MAC-адрес AA:BB:CC:DD:EE:FF" (где это MAC злоумышленника).
3.  Жертва обновляет свою ARP-таблицу этой ложной информацией.
4.  Весь трафик, предназначенный для шлюза, жертва отправляет на MAC-адрес злоумышленника. Злоумышленник может перенаправлять его на настоящий шлюз (атака "man-in-the-middle") или просто анализировать.

**Диаграмма последовательности ARP Spoofing:**

```mermaid
sequenceDiagram
    participant Жертва
    participant Злоумышленник
    participant Шлюз
    participant Коммутатор

    Note over Жертва, Шлюз: Исходное состояние: ARP-таблицы корректны
    Жертва ->> Коммутатор: Кадр для Шлюза (MAC Шлюза)
    Коммутатор ->> Шлюз: Кадр передан на правильный порт

    Note over Злоумышленник: Начало атаки
    Злоумышленник ->> Коммутатор: Поддельный ARP-ответ:<br>"IP Шлюза = MAC Злоумышленника"
    Коммутатор ->> Жертва: (Broadcast) ARP-ответ
    Note left of Жертва: Жертва обновляет ARP-таблицу:<br>IP Шлюза -> MAC Злоумышленника

    Злоумышленник ->> Коммутатор: Поддельный ARP-ответ:<br>"IP Жертвы = MAC Злоумышленника"
    Коммутатор ->> Шлюз: (Broadcast) ARP-ответ
    Note right of Шлюз: Шлюз обновляет ARP-таблицу:<br>IP Жертвы -> MAC Злоумышленника

    Note over Жертва, Шлюз: Состояние после атаки
    Жертва ->> Коммутатор: Кадр для Шлюза (MAC Злоумышленника)
    Коммутатор ->> Злоумышленника: Кадр передан злоумышленнику
    Note over Злоумышленник: Злоумышленник может:<br>1. Просмотреть/изменить пакет<br>2. Переслать его Шлюзу
    Злоумышленник ->> Шлюз: Кадр (MAC Злоумышленника как отправитель)
```

**Меры противодействия:**
*   **Статические ARP-записи** (не масштабируемо).
*   **Dynamic ARP Inspection (DAI)** на управляемых коммутаторах.
*   Использование **VPN** для всего трафика.
*   Средства защиты от ARP-спуфинга на хостах (например, Arpwatch).

---

### 621. Инструменты для перехвата сеанса

**Объяснение:**
Это программы, используемые для проведения атак, описанных выше.

**Примеры инструментов:**
*   **Ettercap:** комплексный инструмент для атак "человек посередине" в LAN. Умеет делать ARP spoofing, перехватывать пароли, внедрять свой код в страницы.
*   **Wireshark:** мощный сетевой анализатор (сниффер) для захвата и детального анализа сетевого трафика.
*   **tcpdump:** консольный сниффер.
*   **Burp Suite:** в основном веб-прокси для тестирования веб-приложений, но его функции включают перехват и модификацию HTTP/S трафика.
*   **BetterCAP:** мощный фреймворк для проведения различных атак, связанных с перехватом трафика, Wi-Fi, Bluetooth и др.
*   **arpspoof** (из пакета dsniff): утилита для проведения ARP spoofing.

---

### 622. Меры противодействия перехвату сеанса (обобщение)

**Объяснение:**
Комплексный подход к защите от всех видов перехвата сеанса.

**Основные меры:**

1.  **Шифрование всего трафика (наиболее эффективная мера):**
    *   **HTTPS (TLS/SSL)** для веб-трафика.
    *   **SSH** для удаленного доступа.
    *   **VPN (IPsec, OpenVPN, WireGuard)** для защиты всего трафика между узлами или между узлом и сетью.
    *   **SFTP/SCP** вместо FTP.
    *   **Защищенные протоколы для почты (SMTPS, IMAPS).**

2.  **Защита на сетевом уровне:**
    *   **Сегментация сети (VLAN)** для ограничения области атаки.
    *   **Настройка портов на коммутаторах:** Port Security, DHCP Snooping, Dynamic ARP Inspection (DAI).
    *   **Фильтрация на маршрутизаторах и фаерволах** (входная/выходная, отбрасывание подозрительных пакетов).

3.  **Аутентификация и управление сессиями:**
    *   Использование **сложных, одноразовых или короткоживущих токенов сессии**.
    *   **Привязка сессии к IP-адресу** (может быть проблематично при смене IP).
    *   **Регулярная регенерация идентификатора сессии**.

4.  **Общие рекомендации по безопасности:**
    *   **Регулярное обновление ПО** для устранения уязвимостей.
    *   **Обучение пользователей** (не использовать открытые Wi-Fi без VPN, не переходить по подозрительным ссылкам).
    *   **Мониторинг сети** для обнаружения аномальной активности (например, неожиданные ARP-запросы).
    *   **Применение принципа минимальных привилегий**.


---

## 573. Концепции Denial-of-Service

**Объяснение:**
DoS (Denial-of-Service) - это кибератака, направленная на нарушение доступности легитимным пользователям. Основная цель - сделать сервис, систему или сетевой ресурс недоступным для целевых пользователей.

**Ключевые характеристики:**
- Нарушение доступности (Availability)
- Исчерпание ресурсов (ресурсов ЦП, памяти, пропускной способности)
- Временное или постоянное нарушение работы
- Может быть нацелена на различные уровни сетевой модели OSI

---

## 574. Что такое DDoS атака

**Объяснение:**
DDoS (Distributed Denial-of-Service) - это распределенная версия DoS атаки, где множество скомпрометированных систем (ботнет) координированно атакуют одну цель.

**Основные отличия DDoS от DoS:**
```mermaid
flowchart TD
    A[DoS vs DDoS] --> B[DoS-атака]
    A --> C[DDoS-атака]
    
    B --> B1[Один источник атаки]
    B --> B2[Легче блокировать]
    B --> B3[Ограниченная мощность]
    
    C --> C1[Множество источников]
    C --> C2[Сложнее блокировать]
    C --> C3[Высокая мощность атаки]
```

---

## 575. Техники DoS/DDoS атак

**Объяснение:**
Основные технические подходы к проведению атак:

1. **Объемные атаки** - заполнение канала связи
2. **Атаки на протоколы** - эксплуатация уязвимостей сетевых протоколов
3. **Атаки на приложения** - целевое воздействие на прикладной уровень

---

## 576. Векторы DoS/DDoS атак

**Объяснение:**
Векторы атак определяют, какие конкретно методы и протоколы используются для атаки:

- **Сетевой уровень**: ICMP flood, IP фрагментация
- **Транспортный уровень**: SYN flood, UDP flood
- **Прикладной уровень**: HTTP flood, Slowloris
- **Отражающие атаки**: DNS amplification, NTP amplification

---

## 577. UDP флуд

**Объяснение:**
Атакующий отправляет большое количество UDP пакетов на случайные порты целевого сервера, заставляя его тратить ресурсы на обработку и отправку ответов.

**Диаграмма последовательности UDP флуд:**

```mermaid
sequenceDiagram
    participant A as Атакующий/Ботнет
    participant T as Целевой сервер
    participant S as Случайные службы
    
    Note over A: Фаза подготовки атаки
    A->>A: Создание множества UDP пакетов<br>со случайными портами
    
    Note over A: Фаза выполнения атаки
    loop Массовая отправка пакетов
        A->>T: UDP пакет на порт X
        T->>S: Проверка службы на порту X
        S-->>T: Служба не найдена
        T->>A: ICMP Destination Unreachable
    end
    
    Note over T: Ресурсы сервера истощены:<br>- Пропускная способность<br>- Процессорное время<br>- Память
```

---

## 578. ICMP флуд

**Объяснение:**
Массовая отправка ICMP пакетов (обычно Echo Request) для перегрузки сетевого канала и ресурсов цели.

**Диаграмма последовательности ICMP флуд:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant T as Целевая система
    
    Note over A: Генерация ICMP пакетов
    A->>A: Создание множества ICMP Echo Request
    
    Note over A: Интенсивная отправка
    loop Каждые несколько миллисекунд
        A->>T: ICMP Echo Request (Ping)
        T->>T: Обработка запроса
        T->>A: ICMP Echo Reply (Pong)
    end
    
    Note over T: Последствия атаки:
    T->>T: Исчерпание пропускной способности
    T->>T: Высокая загрузка CPU
    T->>T: Заполнение буферов сети
```

---

## 579. Ping of death

**Объяснение:**
Отправка фрагментированных ICMP пакетов, которые при сборке превышают максимальный допустимый размер, вызывая сбой в системе.

**Диаграмма последовательности Ping of death:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant T as Целевая система
    participant NW as Сетевое оборудование
    
    Note over A: Подготовка вредоносных пакетов
    A->>A: Создание ICMP пакета > 65535 байт
    A->>A: Фрагментация на части
    
    Note over A: Отправка фрагментов
    loop Для каждого фрагмента
        A->>NW: IP фрагмент с offset
        NW->>T: Передача фрагмента
    end
    
    Note over T: Процесс сборки пакетов
    T->>T: Буферизация фрагментов
    T->>T: Сборка полного пакета
    
    Note over T: Обнаружение переполнения
    T->>T: Размер пакета превышает 65535 байт
    
    alt Уязвимая система
        T->>T: Переполнение буфера
        T->>T: Крах системы/сервиса
    else Защищенная система
        T->>T: Отбрасывание пакета
        T->>T: Запись в лог ошибок
    end
```

---

## 580. Smurf атака

**Объяснение:**
Использование широковещательных ICMP запросов с подменой IP-адреса отправителя на адрес жертвы.

**Диаграмма последовательности Smurf атака:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant R as Маршрутизатор
    participant NW as Сеть жертвы (Broadcast)
    participant V as Жертва
    
    Note over A: Подготовка пакета
    A->>A: Создание ICMP Echo Request<br>Source IP = IP жертвы<br>Destination IP = broadcast сети
    
    A->>R: Отправка поддельного пакета
    R->>NW: Широковещательная рассылка<br>ICMP запроса
    
    Note over NW: Все хочи в сети отвечают жертве
    loop Для каждого хоста в сети
        NW->>V: ICMP Echo Reply
    end
    
    Note over V: Жертва получает лавину ответов
    V->>V: Обработка тысяч ICMP пакетов
    V->>V: Исчерпание сетевых ресурсов
    V->>V: Отказ в обслуживании
```

---

## 581. SYN флуд

**Объяснение:**
Эксплуатация механизма трехстороннего рукопожатия TCP путем отправки множества SYN запросов без завершения соединения.

**Диаграмма последовательности SYN флуд:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant T as Целевой сервер
    participant TB as Таблица полуоткрытых соединений
    
    Note over A: Массовая отправка SYN пакетов
    loop С поддельными IP адресами
        A->>T: TCP SYN (Seq=X)
        T->>TB: Запись полуоткрытого соединения
        T->>A: TCP SYN-ACK (Seq=Y, ACK=X+1)
    end
    
    Note over A: Атакующий не отправляет ACK
    A--xA: Нет ACK ответов
    
    Note over T: Таймауты и накопление соединений
    loop Ожидание ACK
        T->>T: Таймаут ожидания ACK
        T->>TB: Удаление истекшего соединения
    end
    
    Note over TB: Таблица переполняется
    TB->>TB: Все слоты заняты
    TB->>T: Невозможность принимать новые соединения
    
    Note over T: Результат: Отказ в обслуживании<br>для легитимных пользователей
```

---

## 582. Фрагментированная атака

**Объяснение:**
Отправка большого количества фрагментированных пакетов, которые перегружают систему сборки фрагментов.

**Диаграмма последовательности фрагментированной атаки:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant T as Целевая система
    participant RB as Reassembly Buffer
    
    Note over A: Генерация фрагментированных пакетов
    A->>A: Создание тысяч фрагментированных IP пакетов
    
    Note over A: Отправка фрагментов
    loop Массовая отправка
        A->>T: IP Fragment #1
        A->>T: IP Fragment #3
        A->>T: IP Fragment #2
        A->>T: IP Fragment #N...
    end
    
    Note over T: Процесс обработки
    T->>RB: Помещение фрагментов в буфер
    RB->>RB: Ожидание всех частей пакета
    
    Note over RB: Проблемы сборки:
    RB->>RB: Нехватка памяти для буферов
    RB->>RB: Таймауты ожидания фрагментов
    RB->>RB: Невозможность полной сборки
    
    Note over T: Критические последствия:
    T->>T: Исчерпание памяти
    T->>T: Высокая загрузка процессора
    T->>T: Отказ сетевого стека
```

---

## 583. Slowloris

**Объяснение:**
Атака на прикладном уровне, при которой множество неполных HTTP запросов занимают все доступные соединения на веб-сервере.

**Диаграмма последовательности Slowloris:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant W as Веб-сервер
    participant C as Connection Pool
    
    Note over A: Инициализация множества соединений
    A->>W: HTTP GET / HTTP/1.1\r\nHost: example.com\r\n
    W->>C: Резервирование слота соединения
    
    Note over A: Медленная отправка заголовков
    loop Каждые несколько секунд
        A->>W: X-Header-N: data\r\n
        W->>W: Ожидание завершения запроса
    end
    
    Note over A: Поддержание соединений открытыми
    A->>A: Таймер отправки байтов
    
    Note over C: Пул соединений заполняется
    C->>C: Все слоты заняты медленными соединениями
    C->>W: Нет свободных слотов
    
    Note over W: Легитимные пользователи<br>не могут подключиться
    W->>W: HTTP 503 Service Unavailable
```

---

## 584. Мульти-векторные атаки

**Объяснение:**
Комбинация нескольких типов DDoS атак для преодоления систем защиты.

**Диаграмма последовательности мульти-векторной атаки:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant T as Целевая система
    participant D как Система защиты
    
    Note over A: Фаза 1: Объемная атака
    A->>T: UDP Flood
    D->>D: Обнаружение UDP Flood
    D->>T: Блокировка UDP трафика
    
    Note over A: Фаза 2: Атака на протокол
    A->>T: SYN Flood
    D->>D: Обнаружение SYN Flood
    D->>T: Включение SYN cookies
    
    Note over A: Фаза 3: Атака на приложение
    A->>T: HTTP Flood + Slowloris
    D->>D: Затруднения с фильтрацией<br>легитимного трафика
    
    Note over A: Фаза 4: Комбинированная атака
    par Одновременно
        A->>T: DNS Amplification
        A->>T: NTP Amplification
        A->>T: SSDP Reflection
    end
    
    Note over T: Система защиты перегружена
    D->>D: Невозможность обработки<br>всех векторов атаки
    T->>T: Полный отказ в обслуживании
```

---

## 585. DRDoS атаки (Distributed Reflection DoS)

**Объяснение:**
Использование легитимных серверов в качестве "отражателей" для усиления атаки.

**Диаграмма последовательности DRDoS:**

```mermaid
sequenceDiagram
    participant A as Атакующий
    participant R as Отражатели (DNS/NTP/SNMP)
    participant V as Жертва
    
    Note over A: Подготовка запросов
    A->>A: Создание запросов с подменой<br>Source IP = IP жертвы
    
    Note over A: Рассылка на отражатели
    loop Массовая отправка
        A->>R: Запрос (Source IP = V)
        R->>R: Обработка запроса
        R->>V: Ответ (увеличенный в размерах)
    end
    
    Note over V: Получение усиленного трафика
    V->>V: Обработка amplified трафика
    V->>V: Исчерпание ресурсов
    
    Note over R: Отражатели не знают<br>об участии в атаке
```

---

## 586. Бот сети

**Объяснение:**
Сети скомпрометированных устройств (зомби), управляемых злоумышленником (бот-мастером).

**Диаграмма последовательности работы ботнета:**

```mermaid
sequenceDiagram
    participant BM as Бот-мастер
    participant C&C as Сервер управления
    participant B как Боты
    participant T как Цель атаки
    
    Note over BM: Фаза 1: Распространение
    BM->>B: Инфекция через:<br>- Фишинг<br>- Эксплойты<br>- Зараженные программы
    
    Note over BM: Фаза 2: Регистрация ботов
    B->>C&C: Регистрация в ботнете<br>(Heartbeat, IP, возможности)
    
    Note over BM: Фаза 3: Подготовка атаки
    BM->>C&C: Команда на подготовку
    C&C->>B: Рассылка инструкций
    
    Note over BM: Фаза 4: Выполнение DDoS
    BM->>C&C: Команда начала атаки
    C&C->>B: Параметры атаки (цель, тип, длительность)
    
    Note over B: Скоординированная атака
    par Массовая атака
        B->>T: SYN Flood
        B->>T: UDP Flood
        B->>T: HTTP Flood
    end
    
    Note over T: Цель перегружена<br>трафиком от тысяч ботов
```

### Ключевые меры защиты от DDoS атак:

1. **Обнаружение и мониторинг** - системы обнаружения аномалий
2. **Фильтрация трафика** - черные списки, rate limiting
3. **Распределенная инфраструктура** - CDN, балансировщики нагрузки
4. **Аппаратные решения** - специализированные DDoS-протекторы
5. **План реагирования** - процедуры на случай атаки

Каждая диаграмма показывает конкретный механизм атаки, что помогает понять как предотвращать и смягчать последствия различных типов DDoS атак.
