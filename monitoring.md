# üöÄ –ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ Ubuntu 22.04

## üìã –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### **1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∞–≤–∞ sudo
sudo whoami

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Ubuntu
lsb_release -a
```

### **2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —É—Ç–∏–ª–∏—Ç**
```bash
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
sudo apt update && sudo apt upgrade -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç
sudo apt install -y net-tools grep awk sed curl wget
```

---

## üõ†Ô∏è –°–æ–∑–¥–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∫—Ä–∏–ø—Ç–æ–≤

### **–®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
sudo mkdir -p /opt/security-scripts
cd /opt/security-scripts
```

### **–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –°–∫—Ä–∏–ø—Ç–∞ 1 - –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
sudo nano /opt/security-scripts/security_analysis.sh
```

**–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –°–∫—Ä–∏–ø—Ç–∞ 1, –∑–∞—Ç–µ–º:**

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /opt/security-scripts/security_analysis.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Å–∫—Ä–∏–ø—Ç–∞
bash -n /opt/security-scripts/security_analysis.sh
```

### **–®–∞–≥ 3: –°–æ–∑–¥–∞–Ω–∏–µ –°–∫—Ä–∏–ø—Ç–∞ 2 - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
sudo nano /opt/security-scripts/realtime_monitor.sh
```

**–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –°–∫—Ä–∏–ø—Ç–∞ 2, –∑–∞—Ç–µ–º:**

```bash
# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
sudo chmod +x /opt/security-scripts/realtime_monitor.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
bash -n /opt/security-scripts/realtime_monitor.sh
```

### **–®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –°–∫—Ä–∏–ø—Ç–∞ 3 - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
sudo nano /opt/security-scripts/daily_report.sh
```

**–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –°–∫—Ä–∏–ø—Ç–∞ 3, –∑–∞—Ç–µ–º:**

```bash
sudo chmod +x /opt/security-scripts/daily_report.sh
bash -n /opt/security-scripts/daily_report.sh
```

### **–®–∞–≥ 5: –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –æ–ø–æ–≤–µ—â–µ–Ω–∏–π**

```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å–∫—Ä–∏–ø—Ç–∞
sudo nano /opt/security-scripts/alert_system.sh
```

**–í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ alert-—Å–∏—Å—Ç–µ–º—ã, –∑–∞—Ç–µ–º:**

```bash
sudo chmod +x /opt/security-scripts/alert_system.sh
bash -n /opt/security-scripts/alert_system.sh
```

---

## üöÄ –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–æ–≤

### **–ó–∞–ø—É—Å–∫ –°–∫—Ä–∏–ø—Ç–∞ 1 —Å–º. –†–∞–∑–¥–µ–ª üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```bash
# –ó–∞–ø—É—Å–∫ —Å –ø—Ä–∞–≤–∞–º–∏ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
sudo /opt/security-scripts/security_analysis.sh

# –ò–ª–∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
cd /opt/security-scripts
sudo ./security_analysis.sh
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
=== –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –ê–ù–ê–õ–ò–ó –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò ===
–í—Ä–µ–º—è: –ü–Ω –¥–µ–∫ 11 14:30:25 UTC 2023

üîê –ê–ù–ê–õ–ò–ó –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò:
----------------------------
–ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞: 15
–£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã: 3
–¢–æ–ø IP –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
   5 192.168.1.50
   3 103.216.45.12
...
```

### **–ó–∞–ø—É—Å–∫ –°–∫—Ä–∏–ø—Ç–∞ 2 —Å–º. –†–∞–∑–¥–µ–ª üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**
```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
sudo nohup /opt/security-scripts/realtime_monitor.sh &

# –ó–∞–ø—É—Å–∫ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
sudo /opt/security-scripts/realtime_monitor.sh

# –î–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –Ω–∞–∂–º–∏—Ç–µ Ctrl+C
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

### **–ó–∞–ø—É—Å–∫ –°–∫—Ä–∏–ø—Ç–∞ 3 —Å–º. –†–∞–∑–¥–µ–ª üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ : –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç**
```bash
# –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫
sudo /opt/security-scripts/daily_report.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç
cat /tmp/security_report_20231211.txt
```

---

## ‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤**
```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ crontab –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
sudo crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –≤ 6:00 —É—Ç—Ä–∞
0 6 * * * /opt/security-scripts/daily_report.sh

# –ò–ª–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–∞–∂–¥—ã–π —á–∞—Å
0 * * * * /opt/security-scripts/security_analysis.sh >> /var/log/security_analysis.log
```

### **–°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–ª—É–∂–±—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ service —Ñ–∞–π–ª
sudo nano /etc/systemd/system/security-monitor.service
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:**
```ini
[Unit]
Description=Security Monitor Service
After=network.target

[Service]
Type=simple
ExecStart=/opt/security-scripts/realtime_monitor.sh
Restart=always
RestartSec=5
User=root

[Install]
WantedBy=multi-user.target
```

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–ª—É–∂–±—ã:**
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ systemd
sudo systemctl daemon-reload

# –í–∫–ª—é—á–∏—Ç–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
sudo systemctl enable security-monitor.service

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–ª—É–∂–±—É
sudo systemctl start security-monitor.service

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
sudo systemctl status security-monitor.service
```

---

## üîß –†–µ—à–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: "Permission denied"**
```bash
# –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
sudo chmod +x /opt/security-scripts/*.sh
sudo chown root:root /opt/security-scripts/*.sh
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: "No such file or directory" –¥–ª—è –ª–æ–≥–æ–≤**
```bash
# –†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ª–æ–≥-—Ñ–∞–π–ª–æ–≤
sudo ls -la /var/log/auth.log
sudo ls -la /var/log/nginx/access.log

# –ï—Å–ª–∏ nginx –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –µ–≥–æ
sudo apt install -y nginx
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: –°–∫—Ä–∏–ø—Ç –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —à–µ–±–∞–Ω–≥ (–ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞)
head -1 /opt/security-scripts/security_analysis.sh
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: #!/bin/bash

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
ls -la /opt/security-scripts/security_analysis.sh
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: -rwxr-xr-x
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏**
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ net-tools —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
sudo apt install -y net-tools

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥
which netstat
which ss
```

---

## üìä –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤

### **–¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–≤–æ–¥
sudo /opt/security-scripts/security_analysis.sh | tee /tmp/test_output.log

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
grep -E "(–ê–ù–ê–õ–ò–ó|–£—Å–ø–µ—à–Ω—ã–µ|–ù–µ—É–¥–∞—á–Ω—ã–µ|–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ)" /tmp/test_output.log
```

### **–¢–µ—Å—Ç 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ auth.log
echo "$(date) test sshd[12345]: Failed password for root from 192.168.1.100 port 22" | sudo tee -a /var/log/auth.log

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–±—ã—Ç–∏–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è
sudo /opt/security-scripts/realtime_monitor.sh
```

### **–¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ—Ç—á–µ—Ç
sudo /opt/security-scripts/daily_report.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
ls -la /tmp/security_report_*.txt

# –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
cat /tmp/security_report_$(date +%Y%m%d).txt
```

---

## üéØ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—Ç–∞—Ü–∏–∏ –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é logrotate –¥–ª—è security alerts
sudo nano /etc/logrotate.d/security-alerts
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ:**
```
/var/log/security_alerts.log {
    daily
    missingok
    rotate 7
    compress
    delaycompress
    notifempty
    create 644 root root
}
```

### **–°–æ–∑–¥–∞–Ω–∏–µ –∞–ª–∏–∞—Å–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞**
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ ~/.bashrc –∏–ª–∏ /etc/bash.bashrc
alias security-scan='sudo /opt/security-scripts/security_analysis.sh'
alias security-monitor='sudo /opt/security-scripts/realtime_monitor.sh'
alias security-report='sudo /opt/security-scripts/daily_report.sh'

# –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
source ~/.bashrc
```

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email –æ–ø–æ–≤–µ—â–µ–Ω–∏–π**
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–æ—á—Ç–æ–≤—É—é —É—Ç–∏–ª–∏—Ç—É
sudo apt install -y mailutils

# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å—Ç—Ä–æ–∫–∏ –≤ alert_system.sh
# echo "$message" | mail -s "Security Alert: $level" admin@company.com
```

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### **–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–≥—Ä—É–∑–∫–∏ –æ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
```bash
#!/bin/bash
# monitoring_performance.sh

echo "=== –ú–û–ù–ò–¢–û–†–ò–ù–ì –ù–ê–ì–†–£–ó–ö–ò –°–ö–†–ò–ü–¢–û–í ==="

# –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
echo "–ü–∞–º—è—Ç—å:"
ps aux | grep -E "(realtime_monitor|alert_system)" | grep -v grep | awk '{print $4 "% memory"}'

# –ü–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU
echo "CPU:"
ps aux | grep -E "(realtime_monitor|alert_system)" | grep -v grep | awk '{print $3 "% CPU"}'

# –†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
echo "–†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:"
du -sh /var/log/security_alerts.log 2>/dev/null || echo "–§–∞–π–ª –ª–æ–≥–æ–≤ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
```

```bash
# –°–æ–∑–¥–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ
sudo nano /opt/security-scripts/monitoring_performance.sh
sudo chmod +x /opt/security-scripts/monitoring_performance.sh
sudo /opt/security-scripts/monitoring_performance.sh
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏

- [ ] –í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –≤ `/opt/security-scripts/`
- [ ] –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã (chmod +x)
- [ ] –°–∫—Ä–∏–ø—Ç 1 –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–Ω–∞–ª–∏–∑
- [ ] –°–∫—Ä–∏–ø—Ç 2 —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –°–∫—Ä–∏–ø—Ç 3 —Å–æ–∑–¥–∞–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –æ—Ç—á–µ—Ç—ã
- [ ] Systemd —Å–ª—É–∂–±–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
- [ ] Cron –∑–∞–¥–∞–Ω–∏—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- [ ] –õ–æ–≥–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## üÜò –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –Ω–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
for script in /opt/security-scripts/*.sh; do
    echo "–ü—Ä–æ–≤–µ—Ä–∫–∞ $script:"
    bash -n "$script" && echo "‚úÖ OK" || echo "‚ùå –û—à–∏–±–∫–∞"
done

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤
sudo tail -f /var/log/syslog | grep security-scripts

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
top -p $(pgrep -f security-scripts)
```

# üîç –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —É–≥—Ä–æ–∑: –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## üìä –¢–∞–±–ª–∏—Ü–∞ –∫–æ–¥–æ–≤ –æ–ø–∞—Å–Ω–æ—Å—Ç–µ–π –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

### **–°–∏—Å—Ç–µ–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —É–≥—Ä–æ–∑:**

| **–ö–æ–¥** | **–£—Ä–æ–≤–µ–Ω—å –æ–ø–∞—Å–Ω–æ—Å—Ç–∏** | **–¶–≤–µ—Ç** | **–û–ø–∏—Å–∞–Ω–∏–µ** | **–ü—Ä–∏–º–µ—Ä—ã –≤ –ª–æ–≥–∞—Ö** |
|---------|----------------------|----------|--------------|-------------------|
| **CRIT-001** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | üî¥ | –ü—Ä—è–º–∞—è –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã | –£—Å–ø–µ—à–Ω—ã–π –≤–∑–ª–æ–º, –±—ç–∫–¥–æ—Ä—ã |
| **CRIT-002** | –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π | üî¥ | –ü—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø | root-–∫–æ–º–∞–Ω–¥—ã, sudo |
| **HIGH-001** | –í—ã—Å–æ–∫–∏–π | üü† | –ü–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞ | Bruteforce, SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ |
| **HIGH-002** | –í—ã—Å–æ–∫–∏–π | üü† | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã | –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–µ —Ñ–∞–π–ª—ã |
| **MED-001** | –°—Ä–µ–¥–Ω–∏–π | üü° | –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞–∑–≤–µ–¥–∫–∞ | Port scanning, dir traversal |
| **MED-002** | –°—Ä–µ–¥–Ω–∏–π | üü° | –ê–Ω–æ–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | –ù–µ–æ–±—ã—á–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã |
| **LOW-001** | –ù–∏–∑–∫–∏–π | üîµ | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ |
| **INFO-001** | –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π | ‚ö™ | –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å | –õ–µ–≥–∏—Ç–∏–º–Ω—ã–π –¥–æ—Å—Ç—É–ø |

---

## üìã –ú–µ—Ç–æ–¥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤

### **1. –ê–Ω–∞–ª–∏–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (Auth Logs)**

#### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
sudo tail -f /var/log/auth.log

# –ü–æ–∏—Å–∫ —É—Å–ø–µ—à–Ω—ã—Ö –≤–∑–ª–æ–º–æ–≤
grep -i "accepted" /var/log/auth.log
grep -i "session opened" /var/log/auth.log

# –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
grep -i "failed" /var/log/auth.log | head -20
grep -i "invalid" /var/log/auth.log
```

#### **–®–∞–±–ª–æ–Ω—ã –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:**
```bash
# Bruteforce –∞—Ç–∞–∫–∏ (HIGH-001)
grep "Failed password" /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -nr

# –£—Å–ø–µ—à–Ω—ã–π –≤–∑–ª–æ–º (CRIT-001)
grep -E "(session opened|accepted)" /var/log/auth.log | grep -v "sudo\|cron"

# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (CRIT-002)
grep "new user\|useradd" /var/log/auth.log
```

### **2. –ê–Ω–∞–ª–∏–∑ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ (Web Server Logs)**

#### **Nginx/Apache –ª–æ–≥–∏:**
```bash
# –ü–æ–∏—Å–∫ SQL-–∏–Ω—ä–µ–∫—Ü–∏–π (HIGH-001)
grep -E "(union.*select|select.*from|1=1|or 1=1)" /var/log/nginx/access.log

# –ü–æ–∏—Å–∫ XSS –∞—Ç–∞–∫ (HIGH-001)
grep -E "(<script>|alert\(|onload=|onerror=)" /var/log/nginx/access.log

# –ü–æ–∏—Å–∫ path traversal (MED-001)
grep -E "(\.\./|\.\.\\|etc/passwd|bin/sh)" /var/log/nginx/access.log

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (MED-001)
grep -E "(admin|phpmyadmin|wp-admin|\.git|\.env)" /var/log/nginx/access.log
```

#### **–ê–Ω–∞–ª–∏–∑ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```bash
# –¢–æ–ø IP –∞–¥—Ä–µ—Å–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–ø—Ä–æ—Å–æ–≤
awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -nr | head -20

# –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ DDoS (HIGH-002)
awk '{print $4}' /var/log/nginx/access.log | cut -d: -f1 | uniq -c | sort -nr
```

### **3. –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤ (System Logs)**

#### **Syslog –∞–Ω–∞–ª–∏–∑:**
```bash
# –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (CRIT-002)
grep -E "(wget|curl|bash -i|/bin/sh|/bin/bash)" /var/log/syslog

# –ù–µ–æ–±—ã—á–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (HIGH-002)
grep -E "(tmp/|/var/tmp|/dev/shm|\.hidden)" /var/log/syslog

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (MED-002)
grep -E "(chmod|chown|chattr)" /var/log/syslog | grep -v "CRON"
```

---

## üõ°Ô∏è –¢–∞–±–ª–∏—Ü–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä —É–≥—Ä–æ–∑

### **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã (CRIT):**

| **–°–∏–≥–Ω–∞—Ç—É—Ä–∞** | **–ö–æ–¥** | **–û–ø–∏—Å–∞–Ω–∏–µ** | **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞** |
|---------------|---------|--------------|----------------------|
| **–£—Å–ø–µ—à–Ω—ã–π SSH –≤–∑–ª–æ–º** | CRIT-001 | –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ | `grep "Accepted" /var/log/auth.log \| grep -v "192.168.1."` |
| **–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç root** | CRIT-002 | –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ root –∫–æ–º–∞–Ω–¥—ã | `grep "COMMAND" /var/log/auth.log \| grep "root"` |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±—ç–∫–¥–æ—Ä–∞** | CRIT-001 | –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ | `grep -E "(wget.*sh\|curl.*bash)" /var/log/syslog` |

### **–í—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã (HIGH):**

| **–°–∏–≥–Ω–∞—Ç—É—Ä–∞** | **–ö–æ–¥** | **–û–ø–∏—Å–∞–Ω–∏–µ** | **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞** |
|---------------|---------|--------------|----------------------|
| **Bruteforce SSH** | HIGH-001 | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ | `grep "Failed password" /var/log/auth.log \| awk '{print $11}' \| sort \| uniq -c \| sort -nr` |
| **SQL –∏–Ω—ä–µ–∫—Ü–∏–∏** | HIGH-001 | –ü–æ–ø—ã—Ç–∫–∏ SQL-–∞—Ç–∞–∫ | `grep -E "(union.*select\|drop table)" /var/log/nginx/access.log` |
| **–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã** | HIGH-002 | –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–∑ temp –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π | `ps aux \| grep -E "(tmp/\|/var/tmp)"` |

### **–°—Ä–µ–¥–Ω–∏–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã (MED):**

| **–°–∏–≥–Ω–∞—Ç—É—Ä–∞** | **–ö–æ–¥** | **–û–ø–∏—Å–∞–Ω–∏–µ** | **–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞** |
|---------------|---------|--------------|----------------------|
| **–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤** | MED-001 | –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è | `netstat -tun \| awk '{print $5}' \| cut -d: -f1 \| sort \| uniq -c \| sort -nr` |
| **–†–µ–∫–æ–Ω–Ω–æ—Å—Ü–∏—Ä–æ–≤–∫–∞** | MED-001 | –ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π | `grep -E "(phpmyadmin\|wp-admin\|\.git)" /var/log/nginx/access.log` |
| **–ê–Ω–æ–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è** | MED-002 | –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è | `grep "22:[0-5][0-9]:\|03:[0-5][0-9]:" /var/log/auth.log` |

---

## üîß –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### **–°–∫—Ä–∏–ø—Ç 1: –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
```bash
#!/bin/bash
echo "=== –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –ê–ù–ê–õ–ò–ó –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò ==="
echo "–í—Ä–µ–º—è: $(date)"
echo

# 1. –ê–Ω–∞–ª–∏–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
echo "üîê –ê–ù–ê–õ–ò–ó –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò:"
echo "----------------------------"
failed_logins=$(grep "Failed password" /var/log/auth.log 2>/dev/null | wc -l)
success_logins=$(grep "Accepted" /var/log/auth.log 2>/dev/null | wc -l)

echo "–ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞: $failed_logins"
echo "–£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã: $success_logins"

# Bruteforce detection
echo "–¢–æ–ø IP –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:"
grep "Failed password" /var/log/auth.log 2>/dev/null | awk '{print $11}' | sort | uniq -c | sort -nr | head -5

echo

# 2. –ê–Ω–∞–ª–∏–∑ –≤–µ–±-—Ç—Ä–∞—Ñ–∏–∫–∞
echo "üåê –ê–ù–ê–õ–ò–ó –í–ï–ë-–¢–†–ê–§–ò–ö–ê:"
echo "-----------------------"
if [ -f "/var/log/nginx/access.log" ]; then
    suspicious_requests=$(grep -E "(union|select|1=1|script|etc/passwd)" /var/log/nginx/access.log | wc -l)
    echo "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ HTTP –∑–∞–ø—Ä–æ—Å—ã: $suspicious_requests"
    
    echo "–¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP:"
    grep -E "(union|select|1=1)" /var/log/nginx/access.log 2>/dev/null | awk '{print $1}' | sort | uniq -c | sort -nr | head -5
fi

echo

# 3. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
echo "‚öôÔ∏è –ê–ù–ê–õ–ò–ó –ü–†–û–¶–ï–°–°–û–í:"
echo "-------------------"
suspicious_procs=$(ps aux | grep -E "(tmp/|/var/tmp|/dev/shm|\.hidden)" | grep -v grep | wc -l)
echo "–ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã: $suspicious_procs"

# 4. –°–µ—Ç–µ–≤–æ–π –∞–Ω–∞–ª–∏–∑
echo "üåê –°–ï–¢–ï–í–û–ô –ê–ù–ê–õ–ò–ó:"
echo "------------------"
echo "–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:"
netstat -tun | grep ESTABLISHED | wc -l

echo "–ù–µ–æ–±—ã—á–Ω—ã–µ –ø–æ—Ä—Ç—ã:"
netstat -tuln | awk '{print $4}' | grep -E ":(4444|1337|31337)" | wc -l
```

### **–°–∫—Ä–∏–ø—Ç 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**
```bash
#!/bin/bash
# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–≥—Ä–æ–∑ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
echo "üö® –ú–û–ù–ò–¢–û–†–ò–ù–ì –£–ì–†–û–ó –í –†–ï–ê–õ–¨–ù–û–ú –í–†–ï–ú–ï–ù–ò"
echo "–ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏"

tail -f /var/log/auth.log /var/log/nginx/access.log /var/log/syslog 2>/dev/null | \
while read line; do
    # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–≥—Ä–æ–∑—ã
    if echo "$line" | grep -q -E "(Accepted|session opened)"; then
        echo "üî¥ CRIT-001: –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥: $line"
    fi
    
    # –í—ã—Å–æ–∫–æ—Ä–∏—Å–∫–æ–≤—ã–µ —É–≥—Ä–æ–∑—ã
    if echo "$line" | grep -q -E "(union.*select|1=1|script)"; then
        echo "üü† HIGH-001: –í–µ–±-–∞—Ç–∞–∫–∞: $line"
    fi
    
    # Bruteforce –ø–æ–ø—ã—Ç–∫–∏
    if echo "$line" | grep -q "Failed password"; then
        echo "üü° HIGH-002: –ù–µ—É–¥–∞—á–Ω—ã–π –≤—Ö–æ–¥: $line"
    fi
done
```

### **–°–∫—Ä–∏–ø—Ç 3: –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –æ—Ç—á–µ—Ç**
```bash
#!/bin/bash
# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
REPORT_FILE="/tmp/security_report_$(date +%Y%m%d).txt"

{
echo "=== –ï–ñ–ï–î–ù–ï–í–ù–´–ô –û–¢–ß–ï–¢ –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–ò ==="
echo "–î–∞—Ç–∞: $(date)"
echo "–°–µ—Ä–≤–µ—Ä: $(hostname)"
echo

echo "üìä –°–í–û–î–ö–ê –£–ì–†–û–ó:"
echo "================"

# –°–±–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
FAILED_SSH=$(grep "Failed password" /var/log/auth.log | wc -l)
SUCCESS_SSH=$(grep "Accepted" /var/log/auth.log | wc -l)
SQL_INJECTIONS=$(grep -E "(union.*select|1=1)" /var/log/nginx/access.log 2>/dev/null | wc -l)
SCAN_ATTEMPTS=$(grep -E "(phpmyadmin|wp-admin|\.git)" /var/log/nginx/access.log 2>/dev/null | wc -l)

echo "üîê SSH –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:"
echo "  - –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏: $FAILED_SSH"
echo "  - –£—Å–ø–µ—à–Ω—ã–µ –≤—Ö–æ–¥—ã: $SUCCESS_SSH"
echo

echo "üåê –í–µ–±-–∞—Ç–∞–∫–∏:"
echo "  - SQL –∏–Ω—ä–µ–∫—Ü–∏–∏: $SQL_INJECTIONS"
echo "  - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ: $SCAN_ATTEMPTS"
echo

echo "üö® –¢–û–ü –£–ì–†–û–ó:"
echo "============="
echo "1. Bruteforce IP:"
grep "Failed password" /var/log/auth.log | awk '{print $11}' | sort | uniq -c | sort -nr | head -3

echo
echo "2. –í–µ–±-–∞—Ç–∞–∫—É—é—â–∏–µ:"
grep -E "(union|select|1=1)" /var/log/nginx/access.log 2>/dev/null | awk '{print $1}' | sort | uniq -c | sort -nr | head -3

} > $REPORT_FILE

echo "–û—Ç—á–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: $REPORT_FILE"
```

---

## üìà –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ alert-—Å–∏—Å—Ç–µ–º—ã:**
```bash
#!/bin/bash
# –°–∏—Å—Ç–µ–º–∞ –æ–ø–æ–≤–µ—â–µ–Ω–∏–π –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö

# –§—É–Ω–∫—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ alert
send_alert() {
    local level=$1
    local message=$2
    echo "[$(date)] $level: $message" >> /var/log/security_alerts.log
    
    # –û—Ç–ø—Ä–∞–≤–∫–∞ email (—Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø–æ—á—Ç—ã)
    # echo "$message" | mail -s "Security Alert: $level" admin@company.com
}

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f /var/log/auth.log | while read line; do
    # CRITICAL alerts
    if echo "$line" | grep -q "Accepted.*root"; then
        send_alert "CRIT-001" "Root login detected: $line"
    fi
    
    # HIGH alerts
    if echo "$line" | grep -q "Failed password.*root"; then
        send_alert "HIGH-001" "Bruteforce attempt on root: $line"
    fi
done
```

---

## üéØ –®–∞–±–ª–æ–Ω—ã –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã

### **–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ —É–≥—Ä–æ–∑—ã:**

| **–ö–æ–¥ —É–≥—Ä–æ–∑—ã** | **–ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è** | **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –º–µ—Ä—ã** |
|----------------|-------------------------|----------------------|
| **CRIT-001** | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP, –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã | 2FA, –£—Å–∏–ª–µ–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ |
| **HIGH-001** | Rate limiting, –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP, –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | WAF, –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª |
| **MED-001** | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ | ACL –Ω–∞—Å—Ç—Ä–æ–π–∫–∞, –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è —Å–µ—Ç–∏ |

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
2. **–í–Ω–µ–¥—Ä–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º—É –æ–ø–æ–≤–µ—â–µ–Ω–∏–π**
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö**
5. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —É–≥—Ä–æ–∑**

–≠—Ç–∞ —Å–∏—Å—Ç–µ–º–∞ –ø–æ–∑–≤–æ–ª–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –≤—ã—è–≤–ª—è—Ç—å –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —É–≥—Ä–æ–∑—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –Ω–∞ –≤–∞—à–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö.

